<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>fits2cl</TITLE>
<META NAME="description" CONTENT="fits2cl">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idlnode24.htm">
<LINK REL="previous" HREF="idlnode22.htm">
<LINK REL="up" HREF="idl.htm">
<LINK REL="next" HREF="idlnode24.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html507"
  HREF="idlnode22.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html513"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html517"
  HREF="idlnode24.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html515"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html508"
  HREF="idlnode22.htm">fits2alm</A>

<B>Up:</B> <A NAME="tex2html514"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html518"
  HREF="idlnode24.htm">gaussbeam</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000230000000000000000"></A>
<A NAME="idl:fits2cl"></A>
<BR>
 
</H1>
<P>
<b><font size=+6><FONT COLOR="#CC0000">fits2cl</FONT></font></b><hr>
<H3>This IDL facility provides a means to
read from a FITS file an ascii or binary table extension containing power 
spectrum (<SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN>) or spherical harmonics (<SPAN CLASS="MATH"><I>a</I><SUB><I>l m</I></SUB></SPAN>) coefficients, and returns
the corresponding power spectrum (<!-- MATH
 $C(l) = \sum_m a_{lm}a^*_{lm} / (2l+1)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="223" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg45.png"
 ALT="$C(l) = \sum_m a_{lm}a^*_{lm} / (2l+1)$"></SPAN>). Reads primary and extension headers if
required. The facility is intended to enable the user to read the
output from the <b>HEALPix</b> facility <SPAN  CLASS="textbf">anafast</SPAN>.
</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/845/tree/trunk/src/idl/fits/fits2cl.pro"><b>src/idl/fits/fits2cl.pro</b></a>&nbsp;  
<P>
<hr><h1>FORMAT </h1><h3>IDL>
<FONT COLOR="#CC0000">fits2cl</FONT>, 
<A HREF="#idl:fits2cl:cl_array">cl_array</A>, 
[<A HREF="#idl:fits2cl:fitsfile">fitsfile</A>, <A HREF="#idl:fits2cl:extension">EXTENSION=</A> ,
<A HREF="#idl:fits2cl:hdr">HDR=</A> ,
<A HREF="#idl:fits2cl:help">/HELP</A>, 
<A HREF="#idl:fits2cl:interactive">/INTERACTIVE</A>, 
<A HREF="#idl:fits2cl:llfactor">LLFACTOR=</A>, 
<A HREF="#idl:fits2cl:multipoles">MULTIPOLES=</A>,  
<A HREF="#idl:fits2cl:planck1">/PLANCK1=</A>, 
<A HREF="#idl:fits2cl:planck2">/PLANCK2=</A>, 
<A HREF="#idl:fits2cl:rshow">/RSHOW</A>, 
<A HREF="#idl:fits2cl:show">/SHOW</A>, 
<A HREF="#idl:fits2cl:silent">/SILENT=</A>, 
<A HREF="#idl:fits2cl:wmap1">/WMAP1=</A>, 
<A HREF="#idl:fits2cl:wmap5">/WMAP5=</A>, 
<A HREF="#idl:fits2cl:wmap7">/WMAP7=</A>, 
<A HREF="#idl:fits2cl:xhdr">XHDR=</A>]
</h3>
<P>
<hr>
<H1>QUALIFIERS</H1>
 
  </SMALL><DL COMPACT><DT>
<B>cl_array</B>
<DD><A NAME="idl:fits2cl:cl_array"></A>real array of <SPAN CLASS="MATH"><I>C</I><SUB><I>l</I></SUB></SPAN> coefficients read or computed from the
      file. The output dimension depends on the contents of the file. 
	This has dimension either (lmax+1,9) given in the sequence T E B
      TxE TxB ExB ExT BxT BxE <B>or</B>
       (lmax+1,6) given in the sequence T E B
      TxE TxB ExB <B>or</B> (lmax+1,4) for T E B TxE <B>or</B> (lmax+1) for T
    alone. 
<BR>
The convention for the power spectrum is that it is not
      normalised by the Harrison-Zeldovich (flat) spectrum.
<DT>
<B>fitsfile</B>
<DD><A NAME="idl:fits2cl:fitsfile"></A>String containing the name of the FITS file to be read. The
    file contains either <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> power spectra or <SPAN CLASS="MATH"><I>a</I><SUB><I>l m</I></SUB></SPAN> coefficients. In either
    cases, <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> is returned. If <TT>fitsfile</TT> is not set, then
<A HREF="#idl:fits2cl:planck1"><TT>/PLANCK1</TT></A>,
<A HREF="#idl:fits2cl:planck2"><TT>/PLANCK2</TT></A>,
<A HREF="#idl:fits2cl:wmap1"><TT>/WMAP1</TT></A>,
<A HREF="#idl:fits2cl:wmap5"><TT>/WMAP5</TT></A> or
<A HREF="#idl:fits2cl:wmap7"><TT>/WMAP7</TT></A> 
must be set.
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr><H1>KEYWORDS</H1>

  </SMALL><DL COMPACT><DT>
<B>EXTENSION=</B>
<DD><A NAME="idl:fits2cl:extension"></A>extension unit to be read from FITS file: 
 either its 0-based ID number (ie, 0 for first extension <EM>after</EM> primary array) 
 or the case-insensitive value of its EXTNAME keyword.
    <DT>
<B>HDR =</B>
<DD><A NAME="idl:fits2cl:hdr"></A>String array containing on output the primary header
      read from the FITS file. 
    <DT>
<B>/HELP</B>
<DD><A NAME="idl:fits2cl:help"></A>If set, produces an extended help message (using the doc_library
    IDL command). 
    <DT>
<B>/INTERACTIVE</B>
<DD><A NAME="idl:fits2cl:interactive"></A>If set, the plots generated by <A HREF="#idl:fits2cl:show"><TT>/SHOW</TT></A> and <A HREF="#idl:fits2cl:rshow"><TT>/RSHOW</TT></A> options are produced using iPlot routine, allowing 
           for interactive cropping, zooming and annotation of the plots. This
           requires IDL 6.4 or newer to work properly.
    <DT>
<B>LLFACTOR =</B>
<DD><A NAME="idl:fits2cl:llfactor"></A>vector containing on output the factor <SPAN CLASS="MATH"><IMG
 WIDTH="93" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg36.png"
 ALT="$l(l+1)/2\pi$"></SPAN> which is often
          applied to <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> to flatten it for plotting purposes
    <DT>
<B>MULTIPOLES =</B>
<DD><A NAME="idl:fits2cl:multipoles"></A>vector containing on output the multipoles
    <SPAN CLASS="MATH"><I>l</I></SPAN> for which the power spectra are provided. They are either
<BR>           - read from the file (1st column in the Planck format),
<BR>          - or generated by the routine (assuming that all
               multipoles from 0 to lmax included are provided).
<DT>
<B>/PLANCK1</B>
<DD><A NAME="idl:fits2cl:planck1"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><TT>fitsfile</TT></A> 
           is not provided, then a Planck 2013+external data best fit
          model (<A HREF="idlnode36.htm#idl:init_healpix">!healpix</A>.path.test+'planck2013ext_lcdm_cl_v1.fits'
which matches !healpix.path.test+'cl_planck1.fits') 
          defined up to lmax=4500, is read.
<BR>
See !healpix.path.test+'README' for details
<DT>
<B>/PLANCK2</B>
<DD><A NAME="idl:fits2cl:planck2"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><TT>fitsfile</TT></A> 
           is not provided, then a Planck 2015 data best fit
          model (<A HREF="idlnode36.htm#idl:init_healpix">!healpix</A>.path.test+'planck2015_lcdm_cl_v2.fits'
which matches !healpix.path.test+'cl_planck2.fits') 
          defined up to lmax=4900, is read.
<BR>
See !healpix.path.test+'README' for details

<P>
<DT>
<B>/RSHOW</B>
<DD><A NAME="idl:fits2cl:rshow"></A>If set, the raw power spectra <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> read from the file are plotted
    <DT>
<B>/SHOW</B>
<DD><A NAME="idl:fits2cl:show"></A>If set, the rescaled power spectra <!-- MATH
 $l(l+1)C(l)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="129" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg46.png"
 ALT="$l(l+1)C(l)/2\pi$"></SPAN> are plotted
    <DT>
<B>/SILENT</B>
<DD><A NAME="idl:fits2cl:silent"></A>If set, no message is issued during normal execution
<DT>
<B>/WMAP1</B>
<DD><A NAME="idl:fits2cl:wmap1"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><TT>fitsfile</TT></A> 
           is not provided, then one WMAP-1yr best fit
          model
(<A HREF="idlnode36.htm#idl:init_healpix">!healpix</A>.path.test+'wmap_lcdm_pl_model_yr1_v1.fits'
which currently matches !healpix.path.test+'cl.fits') 
          defined up to lmax=3000, is read.
<BR>
See !healpix.path.test+'README' for details
<DT>
<B>/WMAP5</B>
<DD><A NAME="idl:fits2cl:wmap5"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><TT>fitsfile</TT></A>
           is not provided, then one WMAP-5yr best fit
          model (<A HREF="idlnode36.htm#idl:init_healpix">!healpix</A>.path.test+'wmap_lcdm_sz_lens_wmap5_cl_v3.fits'
which matches !healpix.path.test+'cl_wmap5.fits') 
          defined up to lmax=2000, is read.
<BR>
See !healpix.path.test+'README' for details
<DT>
<B>/WMAP7</B>
<DD><A NAME="idl:fits2cl:wmap7"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><TT>fitsfile</TT></A>
           is not provided, then one WMAP-7yr best fit
          model (<A HREF="idlnode36.htm#idl:init_healpix">!healpix</A>.path.test+'wmap_lcdm_sz_lens_wmap7_cl_v4.fits'
which matches !healpix.path.test+'cl_wmap7.fits') 
          defined up to lmax=3726, is read.
<BR>          <B>Note:</B> As opposed to the other WMAP spectra mentionned above, it includes
             a non-vanishing B (or CURL) power spectrum 
             induced by lensing of E (or GRAD) polarization.
<BR>
See !healpix.path.test+'README' for details
<DT>
<B>XHDR =</B>
<DD><A NAME="idl:fits2cl:xhdr"></A>String array containing on output the extension header
      read from the FITS file. 
  </DL><SMALL CLASS="FOOTNOTESIZE">
<SMALL CLASS="FOOTNOTESIZE">  
</SMALL>
<P>
<hr> 
<H1>DESCRIPTION</H1> 
<blockquote>
<FONT COLOR="#CC0000">fits2cl</FONT> reads the power spectrum coefficients from a FITS
file containing an ascii table extension. Descriptive headers conforming
to the FITS convention can also be read from the input file.

</blockquote>
<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">fits2cl</FONT></b></h3>
 
  </SMALL><DL COMPACT><DT>
<B>idl</B>
<DD>version 6.4 or more is necessary to run <FONT COLOR="#CC0000">fits2cl</FONT>.
    <DT>
<B><A HREF="idlnode13.htm#idl:bin_llcl">bin_llcl</A></B>
<DD>facility to bin a spectrum read
with <FONT COLOR="#CC0000">fits2cl</FONT>.
    <DT>
<B><A HREF="idlnode15.htm#idl:bl2fits">bl2fits</A></B>
<DD>facility to write a window function into a FITS file.
    <DT>
<B><A HREF="idlnode19.htm#idl:cl2fits">cl2fits</A></B>
<DD>provides the complimentary routine to write a
      power spectrum to a FITS file.
    <DT>
<B><A HREF="idlnode22.htm#idl:fits2alm">fits2alm</A>, <A HREF="idlnode8.htm#idl:alm2fits">alm2fits</A></B>
<DD>routines to read and write <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients
    <DT>
<B><A HREF="idlnode34.htm#idl:ianafast">ianafast</A></B>
<DD>IDL routine computing <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> files
that can be read by <FONT COLOR="#CC0000">fits2cl</FONT>.
    <DT>
<B>anafast</B>
<DD>F90 facility computing <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> files that can be read by <FONT COLOR="#CC0000">fits2cl</FONT>.
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<HR><H1>EXAMPLE:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <FONT COLOR="#CC0000">fits2cl</FONT>, pwrsp, '$HEALPIX/test/cl.fits', $ </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> 	HDR=hdr, XHDR=xhdr, MULTI=l, LLFACT=fll </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> plot, l, powrsp[*,0]*fll</SMALL></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>
<FONT COLOR="#CC0000">fits2cl</FONT> reads a power spectrum <SPAN CLASS="MATH"><I>C</I>(<I>l</I>)</SPAN> from the input FITS file 
<TT>$HEALPIX/test/cl.fits</TT>
into the variable <TT>pwrsp</TT>,  with optional headers
passed by the string variables <TT>hdr</TT> and <TT>xhdr</TT>. The multipoles <SPAN CLASS="MATH"><I>l</I></SPAN> and
factors <SPAN CLASS="MATH"><IMG
 WIDTH="93" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg36.png"
 ALT="$l(l+1)/2\pi$"></SPAN> are read into <TT>l</TT> and <TT>fll</TT> respectively.
<!-- MATH
 $l(l+1) C(l)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="129" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg46.png"
 ALT="$l(l+1)C(l)/2\pi$"></SPAN> vs <SPAN CLASS="MATH"><I>l</I></SPAN> is then plotted.
</blockquote>
<P>
<SMALL CLASS="FOOTNOTESIZE"></SMALL>
<P>

<P>

<P>
<SMALL CLASS="FOOTNOTESIZE">
 </SMALL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html507"
  HREF="idlnode22.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html513"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html517"
  HREF="idlnode24.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html515"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html508"
  HREF="idlnode22.htm">fits2alm</A>

<B>Up:</B> <A NAME="tex2html514"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html518"
  HREF="idlnode24.htm">gaussbeam</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
