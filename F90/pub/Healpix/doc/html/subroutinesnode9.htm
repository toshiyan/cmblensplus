<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>alm2map_der*</TITLE>
<META NAME="description" CONTENT="alm2map_der*">
<META NAME="keywords" CONTENT="subroutines">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="subroutines.css">

<LINK REL="next" HREF="subroutinesnode10.htm">
<LINK REL="previous" HREF="subroutinesnode8.htm">
<LINK REL="up" HREF="subroutines.htm">
<LINK REL="next" HREF="subroutinesnode10.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html387"
  HREF="subroutinesnode8.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html393"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html397"
  HREF="subroutinesnode10.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html395"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html388"
  HREF="subroutinesnode8.htm">alm2map*</A>

<B>Up:</B> <A NAME="tex2html394"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html398"
  HREF="subroutinesnode10.htm">alm2map_spin*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00090000000000000000"></A>
<A NAME="sub:alm2map_der"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">alm2map_der*</FONT></font></b><hr>
<H3>This routine is a wrapper to four other routines that synthesize a <b>HEALPix</b> 
  temperature (and polarisation) map(s), its (their) first derivatives, and optionally
  its (their) second derivatives.
The routines accept both single and double precision arrays for alm, map, der1 and
der2. The precision of these arrays should match. All maps produced are RING
ordered.
<br><br>See <A NAME="tex2html13"
  HREF="facilities.htm">''Fortran
Facilities''</A>
<A HREF="#fac:sec:bug_synder">Appendix</A> for a note on a bug
affecting the calculation of polarisation derivatives on past versions of this routine.
</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/845/tree/trunk/src/f90/mod/alm_tools.F90"><b>src/f90/mod/alm_tools.F90</b></a>&nbsp;  

<P>
<hr><h1>FORMAT </h1><blockquote><h3>call <FONT COLOR="#CC0000">alm2map_der*</FONT>(
<A HREF="#sub:alm2map_der:nsmax">nsmax</A>, <A HREF="#sub:alm2map_der:nlmax">nlmax</A>, <A HREF="#sub:alm2map_der:nmmax">nmmax</A>, <A HREF="#sub:alm2map_der:alm">alm</A>, <A HREF="#sub:alm2map_der:map">map</A>, <A HREF="#sub:alm2map_der:der1">der1</A>[, <A HREF="#sub:alm2map_der:der2">der2</A>]
)</h3></blockquote>

<P>
<hr><H1>ARGUMENTS</H1>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SPAN  CLASS="textbf">name&nbsp;&amp;&nbsp;dimensionality</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">kind</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SPAN  CLASS="textbf">in/out</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SPAN  CLASS="textbf">description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>
nsmax<A NAME="sub:alm2map_der:nsmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the <SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN> value of the map to synthesize.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>nlmax<A NAME="sub:alm2map_der:nlmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>l</I></SPAN> value used for the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>nmmax<A NAME="sub:alm2map_der:nmmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>m</I></SPAN> value used for the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>alm<A NAME="sub:alm2map_der:alm"></A>(1:p, 0:nlmax, 0:nmmax)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SPC/ DPC</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>The <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> values to make the map
                   from. p is either 1 (temperature only) or 3 (temperature+polarisation).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>map<A NAME="sub:alm2map_der:map"></A>(0:12*nsmax**2-1) <EM>or  </EM>(0:12*nsmax**2-1,1:3)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>temperature
map <SPAN CLASS="MATH"><I>T</I>(<I>p</I>)</SPAN> or temperature + polarisation maps <SPAN CLASS="MATH"><I>T</I>(<I>p</I>)</SPAN>, <SPAN CLASS="MATH"><I>Q</I>(<I>p</I>)</SPAN>, <SPAN CLASS="MATH"><I>U</I>(<I>p</I>)</SPAN> to be synthesized.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>der1<A NAME="sub:alm2map_der:der1"></A>(0:12*nsmax**2-1, 1:2*p)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>contains on output the first
derivatives of T: <!-- MATH
 $\left({\partial T}/{\partial \theta}, {\partial T}/{\partial \phi}/\sin\theta \right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="185" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg23.png"
 ALT="$\left({\partial T}/{\partial \theta}, {\partial T}/{\partial \phi}/\sin\theta \right)
$"></SPAN> or the interleaved derivatives of T, Q, and U: <!-- MATH
 $\left({\partial T}/{\partial
  \theta}, {\partial Q}/{\partial \theta}, {\partial U}/{\partial \theta};\right.$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="203" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg24.png"
 ALT="$\left({\partial T}/{\partial
\theta}, {\partial Q}/{\partial \theta}, {\partial U}/{\partial \theta};\right. $"></SPAN>
<!-- MATH
 $\left.{\partial T}/{\partial \phi}/\sin\theta, \ldots \right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="148" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg25.png"
 ALT="$\left.{\partial T}/{\partial \phi}/\sin\theta, \ldots \right)
$"></SPAN></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>der2<A NAME="sub:alm2map_der:der2"></A>(0:12*nsmax**2-1,1:3*p), OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>If this optional
matrix is passed with this rank, it will contain on output the second derivatives
<!-- MATH
 $\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 T}/{\partial
  \theta\partial\phi}/\sin\theta,\right.$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="231" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg26.png"
 ALT="$\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 T}/{\partial
\theta\partial\phi}/\sin\theta,\right. $"></SPAN> 
<!-- MATH
 $\left.{\partial^2 T}/{\partial \phi^2}/\sin^2\theta \right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="142" HEIGHT="47" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg27.png"
 ALT="$\left.{\partial^2 T}/{\partial \phi^2}/\sin^2\theta \right) $"></SPAN> or
<!-- MATH
 $\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 Q}/{\partial \theta^2},
{\partial^2 Q}/{\partial \theta^2}, \ldots \right)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="276" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg28.png"
 ALT="$\left({\partial^2 T}/{\partial \theta^2}, {\partial^2 Q}/{\partial \theta^2},
{\partial^2 Q}/{\partial \theta^2}, \ldots \right) $"></SPAN> 

<P></TD>
</TR>
</TABLE>

<P>
<HR><H1>EXAMPLE:</H1> 
<tt>use healpix_types 
<BR>
use pix_tools, only : nside2npix 
<BR>
use alm_tools, only : alm2map_der 
<BR>
integer(I4B) :: nside, lmax, mmax, npix, n_plm
<BR>
real(SP), dimension(:), allocatable :: map 
<BR>
real(SP), dimension(:,:), allocatable :: der1, der2 
<BR>
complex(SPC), dimension(:,:,:), allocatable :: alm 
<BR>...
<BR>
nside=256 ; lmax=512 ; mmax=lmax
<BR>
npix=nside2npix(nside)
<BR>
allocate(alm(1:1,0:lmax,0:mmax))
<BR>
allocate(map(0:npix-1))
<BR>
allocate(der1(0:npix-1,1:2), der2(0:npix-1,1:3))
<BR>...
<BR>
call alm2map_der(nside, lmax, mmax, alm, map, der1, der2)  
<BR></tt>
<blockquote>
Make temperature maps and its derivatives from the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> passed in alm. The maps have <SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN> of 256, and are constructed from <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> values up to 512 in <SPAN CLASS="MATH"><I>l</I></SPAN> and <SPAN CLASS="MATH"><I>m</I></SPAN>.
</blockquote>

<P>
<hr><H1>MODULES & ROUTINES</H1><H3>This section lists the modules and routines used by <FONT COLOR="#CC0000">alm2map_der*</FONT>.</h3>
  <DL COMPACT><DT>
<B><A HREF="subroutinesnode92.htm#sub:ring_synthesis">ring_synthesis</A></B>
<DD>Performs FFT over <SPAN CLASS="MATH"><I>m</I></SPAN> for synthesis of the rings.
  <DT>
<B>compute_lam_mm, get_pixel_layout, </B>
<DD><DT>
<B>gen_lamfac_der, gen_mfac,  </B>
<DD><DT>
<B>gen_recfac, init_rescale, l_min_ylm</B>
<DD>Ancillary routines used
  for <SPAN CLASS="MATH"><IMG
 WIDTH="46" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg29.png"
 ALT="$\ {_s}Y_{lm}$"></SPAN> recursion
  <DT>
<B><SPAN  CLASS="textbf">misc_utils</SPAN></B>
<DD>module, containing:
  <DT>
<B><A HREF="subroutinesnode15.htm#sub:assert">assert_alloc</A></B>
<DD>routine to print error message, when an array can not be
  allocated properly
  </DL>

<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">alm2map_der*</FONT></b></h3>
 
  <DL COMPACT><DT>
<B><A HREF="subroutinesnode8.htm#sub:alm2map">alm2map</A></B>
<DD>routine generating maps of temperature
   and polarisation from their  <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>
   <DT>
<B><A HREF="subroutinesnode10.htm#sub:alm2map_spin">alm2map_spin</A></B>
<DD>routine generating maps of
arbitrary spin from their  <SPAN CLASS="MATH"><SUB><I>s</I></SUB><I>a</I><SUB><I>lm</I></SUB></SPAN>
<DT>
<B>synfast</B>
<DD>executable using <FONT COLOR="#CC0000">alm2map_der*</FONT> to synthesize maps.
<DT>
<B><A HREF="subroutinesnode24.htm#sub:create_alm">create_alm</A></B>
<DD>routine to generate randomly
  distributed <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients according to a given power spectrum
  </DL>

<P>

<P>


<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html387"
  HREF="subroutinesnode8.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html393"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html397"
  HREF="subroutinesnode10.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html395"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html388"
  HREF="subroutinesnode8.htm">alm2map*</A>

<B>Up:</B> <A NAME="tex2html394"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html398"
  HREF="subroutinesnode10.htm">alm2map_spin*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
