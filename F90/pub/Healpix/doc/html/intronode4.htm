<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Geometric and Algebraic Properties of HEALPix </TITLE>
<META NAME="description" CONTENT="Geometric and Algebraic Properties of HEALPix ">
<META NAME="keywords" CONTENT="intro">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="intro.css">

<LINK REL="next" HREF="intronode5.htm">
<LINK REL="previous" HREF="intronode3.htm">
<LINK REL="up" HREF="intro.htm">
<LINK REL="next" HREF="intronode5.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html115"
  HREF="intronode3.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html121"
  HREF="intro.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html125"
  HREF="intronode5.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html123"
  HREF="intronode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html116"
  HREF="intronode3.htm">Discretisation of Functions on</A>

<B>Up:</B> <A NAME="tex2html122"
  HREF="intro.htm">Introduction to HEALPix</A>

<B> Next:</B> <A NAME="tex2html126"
  HREF="intronode5.htm">The HEALPix Software Package</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html127"
  HREF="intronode4.htm#SECTION00041000000000000000">RING and NESTED numbering schemes</A>
<LI><A NAME="tex2html128"
  HREF="intronode4.htm#SECTION00042000000000000000">The Unique Identifier scheme</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00040000000000000000">
Geometric and Algebraic Properties of <b>HEALPix</b> </A>
</H1>

<P>
<b>HEALPix</b> is a genuinely curvilinear partition of the sphere into exactly equal area
quadrilaterals of varying shape. The base-resolution comprises twelve pixels in three
rings around the poles and equator. 

<P>
The resolution of the grid is expressed by the parameter <SPAN CLASS="MATH"><IMG
 WIDTH="43" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg9.png"
 ALT="$N_{\rm side}$"></SPAN> which defines the number
of divisions along the side of a base-resolution pixel that is needed to reach a desired
high-resolution partition.

<P>
All pixel centers are placed on <!-- MATH
 $4\times N_{\rm side}-1$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="108" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg10.png"
 ALT="$ 4\times N_{\rm side}-1$"></SPAN> 
rings of constant latitude, 
and are equidistant in azimuth
(on each ring). All iso-latitude rings located between the upper and lower corners of
the equatorial base-resolution pixels, the equatorial zone, 
are divided into the same number of pixels: 
<!-- MATH
 $N_{\rm eq}= 4\times N_{\rm side}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="130" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg11.png"
 ALT="$N_{\rm eq}= 4\times N_{\rm side}$"></SPAN>. The remaining rings are located within the
polar cap regions and contain a varying number of pixels, increasing 
from ring to ring with increasing distance
from the poles by one pixel within each quadrant. 

<P>
Pixel boundaries are non-geodesic and take the very simple 
forms <!-- MATH
 $\cos \theta = a \pm b \cdot \phi$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="133" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg12.png"
 ALT="$\cos \theta = a \pm b \cdot \phi $"></SPAN> in the equatorial zone, 
and <!-- MATH
 $\cos \theta = a + b / \phi^2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="136" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg13.png"
 ALT="$\cos \theta = a + b / \phi^2 $"></SPAN>, or
  <!-- MATH
 $\cos \theta = a + b / (\pi/2 - \phi) ^2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="204" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg14.png"
 ALT="$\cos \theta = a + b / (\pi/2 - \phi) ^2 $"></SPAN>,
in the polar caps. 
This allows one to explicitly check by simple analytical integration the 
exact area equality among pixels,
and to compute efficiently more complex objects, 
e.g. the Fourier transforms of individual pixels.

<P>

<DIV ALIGN="CENTER"><A NAME="fig:Numbering"></A><A NAME="989"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 3:</STRONG>
Cylindrical projection of the <b>HEALPix</b> division of a
sphere and two natural pixel numbering schemes (RING and NESTED) 
allowed by <b>HEALPix</b>. Both numbering schemes map the two dimensional 
distribution
of discrete area elements on a sphere into the one dimensional, 
integer pixel number array,
which is essential for computations involving data sets with very 
large total pixel numbers.
From top to bottom:
Panel one (resolution parameter <!-- MATH
 $N_{\rm side}= 2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="77" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg15.png"
 ALT="$N_{\rm side}= 2$"></SPAN>) and panel two (<!-- MATH
 $N_{\rm side}= 4$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="77" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg16.png"
 ALT="$N_{\rm side}= 4$"></SPAN>)
show the RING scheme for pixel numbering, with the pixel number winding 
down from north to south pole through the consecutive isolatitude rings.
Panel three (resolution parameter <!-- MATH
 $N_{\rm side}= 2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="77" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg15.png"
 ALT="$N_{\rm side}= 2$"></SPAN>) and panel four (<!-- MATH
 $N_{\rm side}= 4$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="77" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg16.png"
 ALT="$N_{\rm side}= 4$"></SPAN>)
show the NESTED scheme for pixel numbering within which the pixel number grows
with consecutive hierarchical subdivisions on a tree structure seeded by 
the twelve 
base-resolution pixels. 
</CAPTION>
<TR><TD>
<DIV CLASS="centerline" ID="par3853" ALIGN="CENTER">
<IMG
  WIDTH="627" HEIGHT="908" ALIGN="BOTTOM" BORDER="0"
 SRC="./introf2.png"
 ALT="Image introf2"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<H2><A NAME="SECTION00041000000000000000">
RING and NESTED numbering schemes</A>
</H2>
Specific geometrical properties allow <b>HEALPix</b> to support two different
numbering schemes for the pixels, as illustrated in Figure&nbsp;<A HREF="#fig:Numbering">3</A>. 

<P>
First, in the RING scheme, 
one can simply count the pixels moving down from the north 
to the south pole along each
iso-latitude ring. It is in the RING scheme that Fourier transforms 
with spherical harmonics
are easy to implement.

<P>
Second, in the NESTED scheme, one can arrange the pixel indices 
in  twelve tree structures, corresponding to base-resolution pixels.
Each of those is organised as shown in Fig.&nbsp;<A HREF="intronode3.htm#fig:quadtree">1</A>. This can easily be implemented
since, due to the simple 
description of pixel boundaries, the analytical mapping of the <b>HEALPix</b> 
base-resolution elements (curvilinear
quadrilaterals) into a [0,1]<SPAN CLASS="MATH"> x </SPAN>[0,1] square exists.
This tree structure allows one to implement efficiently all
applications involving  nearest-neighbour searches
(<A
 HREF="intronode9.htm#whg">Wandelt, Hivon &amp; G&#243;rski , 1998</A>),
and also allows for an immediate
construction of the fast Haar wavelet transform on <b>HEALPix</b>. 

<P>

<H2><A NAME="SECTION00042000000000000000"></A>
<A NAME="intro:unique"></A>
<BR>
The Unique Identifier scheme
</H2>
As exposed above, a <b>HEALPix</b> pixel is identified by three variables:
its numbering scheme (RING or NESTED), 
its resolution or size parameter <!-- MATH
 $N_{\rm side}= 2^k$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="86" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg17.png"
 ALT="$N_{\rm side}= 2^k$"></SPAN> (where <SPAN CLASS="MATH"><I>k</I></SPAN> is a integer sometimes called 'order'),
and its index <SPAN CLASS="MATH"><I>p</I></SPAN> lying in <!-- MATH
 $[0, 12N_{\rm side}^2-1]$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="122" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg18.png"
 ALT="$[0, 12N_{\rm side}^2-1]$"></SPAN>.
Since some applications require to process simultaneously pixels of different resolutions, it is possible
to merge the resolution <SPAN CLASS="MATH"><IMG
 WIDTH="43" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg9.png"
 ALT="$N_{\rm side}$"></SPAN> and index <SPAN CLASS="MATH"><I>p</I></SPAN> into a single unique number <SPAN CLASS="MATH"><I>u</I></SPAN>
<BR>
<DIV ALIGN="CENTER"><A NAME="eq:nest2uniq"></A>
<!-- MATH
 \begin{eqnarray}
u_{\ } &\myequal& p + 4 N_{\rm side}^2,
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="22" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg19.png"
 ALT="$\displaystyle u_{\ }$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="19" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg20.png"
 ALT="$\textstyle \myequal$"></TD>
<TD ALIGN="LEFT" WIDTH="50%" NOWRAP><IMG
 WIDTH="90" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg21.png"
 ALT="$\displaystyle p + 4 N_{\rm side}^2,$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">1</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
so that all pixels with <!-- MATH
 $N_{\rm side}=1$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="77" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg22.png"
 ALT="$N_{\rm side}=1$"></SPAN> have the unique indices 4 to 15, 
those with <!-- MATH
 $N_{\rm side}=2$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="77" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg23.png"
 ALT="$N_{\rm side}=2$"></SPAN> are in the range 16 to 63, and so on (<A
 HREF="intronode9.htm#rh15">Reinecke &amp; Hivon, 2015</A>), 
thus simplifying the handling of data with heteregenous <SPAN CLASS="MATH"><IMG
 WIDTH="43" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg9.png"
 ALT="$N_{\rm side}$"></SPAN>.
Splitting the unique index <SPAN CLASS="MATH"><I>u</I></SPAN> into its original <SPAN CLASS="MATH"><IMG
 WIDTH="43" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg9.png"
 ALT="$N_{\rm side}$"></SPAN> and <SPAN CLASS="MATH"><I>p</I></SPAN> is as simple as
<BR>
<DIV ALIGN="CENTER"><A NAME="eq:ring2nest_a"></A><A NAME="eq:ring2nest_b"></A>
<!-- MATH
 \begin{eqnarray}
N_{\rm side}&\myequal& 2^{\rm {floor}\left( \log_2(u/4)/2 \right)},\\
	     p_{\ } &\myequal& u - 4 N_{\rm side}^2,
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="43" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg24.png"
 ALT="$\displaystyle N_{\rm side}$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="19" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg20.png"
 ALT="$\textstyle \myequal$"></TD>
<TD ALIGN="LEFT" WIDTH="50%" NOWRAP><IMG
 WIDTH="126" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg25.png"
 ALT="$\displaystyle 2^{\rm {floor}\left( \log_2(u/4)/2 \right)},$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">2</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG
 WIDTH="21" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg26.png"
 ALT="$\displaystyle p_{\ }$"></TD>
<TD ALIGN="CENTER" NOWRAP><IMG
 WIDTH="19" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg20.png"
 ALT="$\textstyle \myequal$"></TD>
<TD ALIGN="LEFT" WIDTH="50%" NOWRAP><IMG
 WIDTH="91" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg27.png"
 ALT="$\displaystyle u - 4 N_{\rm side}^2,$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(<SPAN CLASS="arabic">3</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL"><P></P>
giving immediate access to the usual pixel based tools.

<P>
This unique indexing could in principle be applied to both the RING and NESTED schemes, 
even though the latter appears more relevant for a hierarchical description 
of data with variable resolutions: since, as noted previously, a pixel with NESTED index <SPAN CLASS="MATH"><I>p</I></SPAN> 
at resolution <SPAN CLASS="MATH"><IMG
 WIDTH="43" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg9.png"
 ALT="$N_{\rm side}$"></SPAN> is subdivided in four pixels with index <!-- MATH
 $4p,\, 4p+1,\, 4p+2,\, 4p+3$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="211" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg28.png"
 ALT="$4p,\, 4p+1,\, 4p+2,\, 4p+3$"></SPAN> 
at resolution <SPAN CLASS="MATH"><IMG
 WIDTH="52" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg29.png"
 ALT="$2N_{\rm side}$"></SPAN>, Eq.&nbsp;(<A HREF="#eq:nest2uniq">1</A>) shows that
a pixel with Nested-based unique identifier <SPAN CLASS="MATH"><I>u</I></SPAN> is subdivided in four smaller pixels 
whose unique identifiers are <!-- MATH
 $4u,\, 4u+1,\, 4u+2,\, 4u+3$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="216" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="introimg30.png"
 ALT="$4u,\, 4u+1,\, 4u+2,\, 4u+3$"></SPAN>.
This Nested-based Unique identification is for instance the basis of the <TT>NUNIQ</TT> storage scheme used for Multi-Order Coverage map (MOC) description of astronomical datasets proposed for virtual observatories (<A
 HREF="intronode9.htm#moc">Boch et al, 2014</A>).

<P>
Routines implementing Eqs&nbsp;(<A HREF="#eq:nest2uniq">1</A>) and (<A HREF="#eq:ring2nest_a">2</A>, <A HREF="#eq:ring2nest_b">3</A>) in various languages have been available since release 3.30.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html115"
  HREF="intronode3.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html121"
  HREF="intro.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html125"
  HREF="intronode5.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html123"
  HREF="intronode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html116"
  HREF="intronode3.htm">Discretisation of Functions on</A>

<B>Up:</B> <A NAME="tex2html122"
  HREF="intro.htm">Introduction to HEALPix</A>

<B> Next:</B> <A NAME="tex2html126"
  HREF="intronode5.htm">The HEALPix Software Package</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
