<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>write_fits_cut4 </TITLE>
<META NAME="description" CONTENT="write_fits_cut4 ">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idlnode71.htm">
<LINK REL="previous" HREF="idlnode69.htm">
<LINK REL="up" HREF="idl.htm">
<LINK REL="next" HREF="idlnode71.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html1071"
  HREF="idlnode69.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1077"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1081"
  HREF="idlnode71.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1079"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1072"
  HREF="idlnode69.htm">vec2ang</A>

<B>Up:</B> <A NAME="tex2html1078"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html1082"
  HREF="idlnode71.htm">write_fits_map</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000700000000000000000"></A>
<A NAME="idl:write_fits_cut4"></A>
<BR>
 
</H1>
<P>
<b><font size=+6><FONT COLOR="#CC0000">write_fits_cut4 </FONT></font></b><hr>
<H3>This IDL facility writes out a cut sky <b>HEALPix</b> map into a FITS file according to
the <b>HEALPix</b> convention. The format used for the
FITS file follows the one used for Boomerang98 and is adapted from
COBE/DMR. This routine can be used to store polarized maps, where the
information relative to the Stokes parameters I, Q and U are placed in extension
0, 1 and 2 respectively by successive invocation of the routine.</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/845/tree/trunk/src/idl/fits/write_fits_cut4.pro"><b>src/idl/fits/write_fits_cut4.pro</b></a>&nbsp;  
<P>
<hr><h1>FORMAT </h1><h3>IDL>
WRITE_FITS_CUT4 , <A HREF="#idl:write_fits_cut4:File">File</A>, <A HREF="#idl:write_fits_cut4:Pixel">Pixel</A>, <A HREF="#idl:write_fits_cut4:Signal">Signal</A>[, <A HREF="#idl:write_fits_cut4:N_Obs">N_Obs</A>, <A HREF="#idl:write_fits_cut4:Serror">Serror</A>, 
<A HREF="#idl:write_fits_cut4:COORDSYS">COORDSYS=</A>, 
<A HREF="#idl:write_fits_cut4:EXTENSION">EXTENSION=</A>, 
<A HREF="#idl:write_fits_cut4:HDR">HDR=</A>,
<A HREF="#idl:write_fits_cut4:NESTED">/NESTED</A>, 
<A HREF="#idl:write_fits_cut4:NSIDE">NSIDE=</A>, 
<A HREF="#idl:write_fits_cut4:ORDERING">ORDERING=</A>, 
<A HREF="#idl:write_fits_cut4:POLARISATION">/POLARISATION</A>,
<A HREF="#idl:write_fits_cut4:RING">/RING</A>,
<A HREF="#idl:write_fits_cut4:UNITS">UNITS=</A>,
<A HREF="#idl:write_fits_cut4:XHDR">XHDR=</A>,
<A HREF="#idl:write_fits_cut4:HELP">HELP=</A>]

</h3>
<P>
<hr>
<H1>QUALIFIERS</H1>
 
  </SMALL><DL COMPACT><DT>
<B>File</B>
<DD><A NAME="idl:write_fits_cut4:File"></A>          name of a FITS file in which the map is to be written

<P>
<DT>
<B>Pixel</B>
<DD><A NAME="idl:write_fits_cut4:Pixel"></A>	 (LONG or LONG64 vector), 
<BR>
index of observed (or valid) pixels

<P>
<DT>
<B>Signal</B>
<DD><A NAME="idl:write_fits_cut4:Signal"></A>	 (FLOAT or DOUBLE vector, same size as Pixel), 
<BR>
value of signal in each observed pixel

<P>
<DT>
<B>N_Obs</B>
<DD><A NAME="idl:write_fits_cut4:N_Obs"></A>	 (LONG or INT or LONG64 vector, Optional, same size as Pixel), 
<BR>
number of
	 observation per pixel. 
<BR>
If absent, the field <TT>N_OBS</TT> will take a value of 1 in the output file.
         If set to a scalar constant, <TT>N_OBS</TT> will take this value in the
	 output file

<P>
<DT>
<B>Serror</B>
<DD><A NAME="idl:write_fits_cut4:Serror"></A>	 (FLOAT or DOUBLE vector, Optional, same size as Pixel)
<BR><EM>rms</EM> of signal in pixel, for white noise,
                   this is <!-- MATH
 $\propto 1/\sqrt{{\rm n\_obs}}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="104" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg91.png"
 ALT="$\propto 1/\sqrt{{\rm n\_obs}}$"></SPAN> 
<BR>
If absent, the field <TT>SERROR</TT> will take a value of 0.0 in the output file.
         If set to a scalar constant, <TT>SERROR</TT> will take this value in the
	 output file

<P>
</DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr><H1>KEYWORDS</H1>

  </SMALL><DL COMPACT><DT>
<B>COORDSYS=</B>
<DD><A NAME="idl:write_fits_cut4:COORDSYS"></A>		  (optional), 
<BR>
if set to either 'C', 'E' or 'G',  specifies that the
		Healpix coordinate system is respectively Celestial=equatorial,
		  Ecliptic or Galactic.
		(The relevant keyword is then added/updated in the extension
		  header, but the map is NOT rotated)

<P>
<DT>
<B>EXTENSION=</B>
<DD><A NAME="idl:write_fits_cut4:EXTENSION"></A>		  (optional), 
<BR>	  (0 based) extension number in which to write data. <b>default:</b>0.
	  If set to 0 (or not set) <EM>a new file is written from scratch</EM>.
	  If set to a value
		  larger than 1, the corresponding extension is added or
		  updated, as long as all previous extensions already exist.
		  All extensions of the same file should use the same ORDERING,
		  NSIDE and COORDSYS.

<P>
<DT>
<B>HDR=</B>
<DD><A NAME="idl:write_fits_cut4:HDR"></A>(optional), 
<BR>
String array containing the information to be put in
		the primary header. 

<P>
<DT>
<B>/NESTED</B>
<DD><A NAME="idl:write_fits_cut4:NESTED"></A>(optional)
         if set, specifies that the map is in the NESTED ordering
	scheme
<BR>	<i>see also:</i>Ordering and Ring 

<P>
<DT>
<B>NSIDE=</B>
<DD><A NAME="idl:write_fits_cut4:NSIDE"></A>		(optional), 
<BR>
scalar integer, <b>HEALPix</b> resolution parameter of the
		data set. The resolution parameter should be made
		available to the FITS file, either thru this
		qualifier, or via the header (see XHDR).

<P>
<DT>
<B>ORDERING=</B>
<DD><A NAME="idl:write_fits_cut4:ORDERING"></A>		  (optional), 
<BR>
if set to either 'ring' or 'nested' (case un-sensitive),
		  specifies that the map is respectively in RING or NESTED
		  ordering scheme
<BR>		<i>see also:</i>Nested and Ring 
<BR>
The ordering information should be made
		available to the FITS file, either thru a combination
		  of Ordering/Ring/Nested, or via the header (see XHDR).

<P>
<DT>
<B>/POLARISATION</B>
<DD><A NAME="idl:write_fits_cut4:POLARISATION"></A>	  specifies that file will contain the I, Q and U polarisation
           Stokes parameter in extensions 0, 1 and 2 respectively, and sets the
FITS header keywords accordingly

<P>
<DT>
<B>/RING</B>
<DD><A NAME="idl:write_fits_cut4:RING"></A> if set, specifies that the map is in the RING ordering
	scheme
<BR>	<i>see also:</i>Ordering and Nested

<P>
<DT>
<B>UNITS=</B>
<DD><A NAME="idl:write_fits_cut4:UNITS"></A>		(optional), 
<BR>
string describing the physical units of the data set (only applies
		to Signal and Serror)

<P>
<DT>
<B>XHDR=</B>
<DD><A NAME="idl:write_fits_cut4:XHDR"></A>(optional), 
<BR>
String array containing the information to be put in
		the extension header. 

<P>
<DT>
<B>HELP=</B>
<DD><A NAME="idl:write_fits_cut4:HELP"></A>(optional), 
<BR>
if set, an extensive help is displayed, and no file is written

<P>
</DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr> 
<H1>DESCRIPTION</H1> 
<blockquote>
<br><br></blockquote>
<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">write_fits_cut4 </FONT></b></h3>
 
  </SMALL><DL COMPACT><DT>
<B>idl</B>
<DD>version 6.4 or more is necessary to run <FONT COLOR="#CC0000">write_fits_cut4 </FONT>
  <DT>
<B><A HREF="idlnode58.htm#idl:read_fits_cut4">read_fits_cut4</A></B>
<DD>This <b>HEALPix</b> IDL facility can be used to read in maps
  written by <FONT COLOR="#CC0000">write_fits_cut4 </FONT>.
  <DT>
<B><A HREF="#idl:write_fits_cut4">write_fits_cut4</A>,
<A HREF="idlnode71.htm#idl:write_fits_map">write_fits_map</A></B>
<DD><DT>
<B><A HREF="idlnode73.htm#idl:write_tqu">write_tqu</A>,
<A HREF="idlnode72.htm#idl:write_fits_sb">write_fits_sb</A></B>
<DD><b>HEALPix</b> IDL routines to write cut-sky maps, full-sky maps, polarized full-sky maps and
arbitrary data sets into FITS files
  <DT>
<B>sxaddpar</B>
<DD>This IDL routine (included in <b>HEALPix</b> package) can be used to update
  or add FITS keywords to the header in <TT>HDR</TT> and <TT>XHDR</TT>
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr><H1>EXAMPLE # 1:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <FONT COLOR="#CC0000">write_fits_cut4 </FONT>, 'map_cut.fits', pixel, temperature, /ring,nside=32, /pol </SMALL></TD>
<TD></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>writes in 'map_cut.fits' a FITS file containing the temperature measured in a
  set of <b>HEALPix</b> pixel.
</blockquote><hr><H1>EXAMPLE # 2:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <FONT COLOR="#CC0000">write_fits_cut4 </FONT>,  'tqu_cut.fits', pixel, temperature, n_t, s_t, $ </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="idlimg43.png"
 ALT="$\quad$"></SPAN>		    /ring, nside=32, /pol </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <FONT COLOR="#CC0000">write_fits_cut4 </FONT>,  'tqu_cut.fits', pixel, qstokes, n_q, s_q, $ </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="idlimg43.png"
 ALT="$\quad$"></SPAN>		    /ring, nside=32, /pol, ext=1</SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <FONT COLOR="#CC0000">write_fits_cut4 </FONT>,  'tqu_cut.fits', pixel, ustokes, n_u, s_u, $ </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> <SPAN CLASS="MATH"><IMG
 WIDTH="23" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="idlimg43.png"
 ALT="$\quad$"></SPAN>		    /ring, nside=32, /pol, ext=2</SMALL></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>writes in 'tqu_cut.fits' a FITS file with three extensions, each of them containing
information on the observed pixel, the measured signal, the number of
observations and noise per pixel, for the three Stokes parameters I, Q and U
respectively. The <b>HEALPix</b> ring ordered scheme and the resolution <!-- MATH
 $N_{\rm side}=32$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="87" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg106.png"
 ALT="$N_{\rm side}=32$"></SPAN> is assumed.
</blockquote>
<P>

<P>
<SMALL CLASS="FOOTNOTESIZE">
 </SMALL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1071"
  HREF="idlnode69.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1077"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1081"
  HREF="idlnode71.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1079"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1072"
  HREF="idlnode69.htm">vec2ang</A>

<B>Up:</B> <A NAME="tex2html1078"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html1082"
  HREF="idlnode71.htm">write_fits_map</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
