<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020 (Released January 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>alm2fits</TITLE>
<META NAME="description" CONTENT="alm2fits">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020">
<!--Begin favicon-->
   <link rel='apple-touch-icon' sizes='180x180' href='images/favicons/apple-touch-icon.png?v=2017'>
   <link rel='icon' type='image/png' sizes='32x32' href='images/favicons/favicon-32x32.png?v=2017'>
   <link rel='icon' type='image/png' sizes='16x16' href='images/favicons/favicon-16x16.png?v=2017'>
   <link rel='manifest' href='images/favicons/manifest.json?v=2017'>
   <link rel='mask-icon' href='images/favicons/safari-pinned-tab.svg?v=2017' color='#5bbad5'>
   <link rel='shortcut icon' href='images/favicons/favicon.ico?v=2017'>
   <meta name='apple-mobile-web-app-title' content='HEALPix'>
   <meta name='application-name' content='HEALPix'>
   <meta name='msapplication-config' content='images/favicons/browserconfig.xml?v=2017'>
   <meta name='theme-color' content='#ffffff'>
<!--End favicon-->

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idl_ang2vec.htm">
<LINK REL="previous" HREF="idl_alm_t2i.htm">
<LINK REL="next" HREF="idl_ang2vec.htm">
</HEAD>

<body>

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="idl_alm_t2i.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="idl_HEALPix_IDL_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="idl_ang2vec.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html320"
  HREF="idl_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<strong> Previous:</strong> <A
 HREF="idl_alm_t2i.htm">alm_t2i</A>

<strong>Up:</strong> <A
 HREF="idl_HEALPix_IDL_subroutines.htm">HEALPix/IDL subroutines</A>

<strong> Next:</strong> <A
 HREF="idl_ang2vec.htm">ang2vec</A>
<strong> Top:</strong> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION800"></A>
<A ID="idl:alm2fits"></A>
<BR>
 
</H1>

<P>
<div class="facility"><SPAN CLASS="colordoc">alm2fits</SPAN></div><hr>
<H3>This IDL routine provides a means to write 
spherical harmonic coefficients (and optional errors) and their index label
to a FITS file. Each signal is written to a separate binary table
extension. The routine also writes header information if required.
The facility is primarily designed to allow the user to write 
a FITS files containing constraints for a constrained realisation
performed by the <strong>HEALPix</strong> facility <SPAN  CLASS="textbf">synfast</SPAN>.
</H3>
Location in HEALPix directory tree: <a href="https://healpix.sourceforge.io/src/3.80/src/idl/fits/alm2fits.pro"><strong>src/idl/fits/alm2fits.pro</strong></a>&nbsp;  

<P>
<hr><h2>FORMAT </h2><h3>IDL>
ALM2FITS, 
<A HREF="#idl:alm2fits:index">index</A>, 
<A HREF="#idl:alm2fits:alm_array">alm_array</A>, 
<A HREF="#idl:alm2fits:fitsfile">fitsfile</A>, [<A HREF="#idl:alm2fits:hdr">HDR=</A>, 
<A HREF="#idl:alm2fits:help">/HELP</A>, 
<A HREF="#idl:alm2fits:xhdr">XHDR=</A>]
</h3>

<P>
<hr>
<H2>QUALIFIERS</H2>
 
  <DL COMPACT><DT>
<B>index</B>
<DD><A ID="idl:alm2fits:index"></A>Long array containing the index for the corresponding
                 array of alm coefficients (and erralm if required). The
                 index <SPAN CLASS="MATH"><I>i</I></SPAN> is related to <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.10ex; vertical-align: -0.55ex; " SRC="idl_img18.png"
 ALT="$\ell,m$"></SPAN> by the relation <BR>
                 <!-- MATH
 $i =\ell^2 + \ell + m + 1$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.04ex; vertical-align: -0.28ex; " SRC="idl_img10.png"
 ALT="$i = \ell^2 + \ell + m + 1$"></SPAN>
    <DT>
<B>alm_array</B>
<DD><A ID="idl:alm2fits:alm_array"></A>Real array of alm coefficients written to the
      file. This has dimension (nl,nalm,nsig) &ndash; corresponding to
<BR>
nl   = number of l,m indices <BR>
nalm = 2 for real and imaginary parts of alm coefficients or
             4 for above plus corresponding error values <BR>
nsig = number of signals to be written (1 for any of T E B
             or 3 if ALL to be written). Each signal is stored
             in a separate extension.
    <DT>
<B>fitsfile</B>
<DD><A ID="idl:alm2fits:fitsfile"></A>String containing the name of the file to be
      written.
  </DL>

<P>
<hr><H2>KEYWORDS</H2>

  <DL COMPACT><DT>
<B>HDR =</B>
<DD><A ID="idl:alm2fits:hdr"></A>String array containing the primary header to be written in the FITS
      file. 
    <DT>
<B>/HELP</B>
<DD><A ID="idl:alm2fits:help"></A>If set, the routine documentation header is shown and the routine exits	
    <DT>
<B>XHDR =</B>
<DD><A ID="idl:alm2fits:xhdr"></A>String array containing the extension header. If
                  ALL signals are required, then each extension table
                  is given this header.
    <DT>
<DD>NOTE: optional header strings should NOT include the
             header keywords explicitly written by this routine.
  </DL>

<P>
<hr> 
<H2>DESCRIPTION</H2> 
<blockquote>
<SPAN CLASS="colordoc">alm2fits</SPAN> writes the input alm coefficients (and associated errors if 
required) into a FITS file. Each signal type is written as a separate
binary table extension. Optional headers conforming
to the FITS convention can also be written to the output file. All
required FITS header keywords are automatically generated by the
routine and should NOT be duplicated in the optional header inputs.
The keywords EXTNAME and TTYPE* are now also automatically generated.

</blockquote>

<P>
<hr><H2>RELATED ROUTINES</H2><h3>This section lists the routines related to <b><SPAN CLASS="colordoc">alm2fits</SPAN></b></h3>
 
  <DL COMPACT><DT>
<B>idl</B>
<DD>version 6.4 or more is necessary to run <SPAN CLASS="colordoc">alm2fits</SPAN>.
    <DT>
<B><A HREF="idl_fits2alm.htm#idl:fits2alm">fits2alm</A></B>
<DD>provides the complimentary routine to read in 
      alm coefficients from a FITS file.
    <DT>
<B><A HREF="idl_alm_i2t.htm#idl:alm_i2t">alm_i2t</A>, <A HREF="idl_alm_t2i.htm#idl:alm_t2i">alm_t2i</A></B>
<DD>these facilities turn indexed lists of <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="idl_img1.png"
 ALT="$a_{\ell m}$"></SPAN> into 2D a(l,m) tables and back
    <DT>
<B><A HREF="idl_lm2index.htm#idl:lm2index">lm2index</A></B>
<DD>converts the <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="idl_img1.png"
 ALT="$a_{\ell m}$"></SPAN> order and degree
    <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img19.png"
 ALT="$(\ell, m)$"></SPAN> into the index <!-- MATH
 $i =\ell^2 + \ell + m + 1$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.04ex; vertical-align: -0.28ex; " SRC="idl_img10.png"
 ALT="$i = \ell^2 + \ell + m + 1$"></SPAN> required by
<SPAN CLASS="colordoc">alm2fits</SPAN>.
    <DT>
<B><A HREF="idl_cl2fits.htm#idl:cl2fits">cl2fits</A></B>
<DD>routine to write a power spectrum into
a FITS file.
    <DT>
<B><A HREF="idl_fits2cl.htm#idl:fits2cl">fits2cl</A></B>
<DD>routine to read/compute <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> power spectra 
   from a file containing <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> or <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="idl_img1.png"
 ALT="$a_{\ell m}$"></SPAN> coefficients
    <DT>
<B>alteralm</B>
<DD>utilises the output file generated by <SPAN CLASS="colordoc">alm2fits</SPAN>.
    <DT>
<B>synfast</B>
<DD>utilises the output file generated by <SPAN CLASS="colordoc">alm2fits</SPAN>.
  </DL>

<P>
<HR><H2>EXAMPLE:</H2> 
<div class="texttt"><TABLE class="PAD " style="">
<TR><TD CLASS="LEFT"><SPAN CLASS="colordoc">alm2fits</SPAN>, index, alm, 'alm.fits', HDR = hdr, XHDR = xhdr</TD>
</TR>
</TABLE></div>
<blockquote>
<SPAN CLASS="colordoc">alm2fits</SPAN> writes the coefficients stored in the variable <SPAN style="font-family:monospace">alm</SPAN>
to the output FITS file <SPAN style="font-family:monospace">alm.fits</SPAN> with optional headers
passed by the string variables <SPAN style="font-family:monospace">hdr</SPAN> and <SPAN style="font-family:monospace">xhdr</SPAN>.
</blockquote>

<P>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="idl_alm_t2i.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="idl_HEALPix_IDL_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="idl_ang2vec.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html320"
  HREF="idl_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<strong> Previous:</strong> <A
 HREF="idl_alm_t2i.htm">alm_t2i</A>

<strong>Up:</strong> <A
 HREF="idl_HEALPix_IDL_subroutines.htm">HEALPix/IDL subroutines</A>

<strong> Next:</strong> <A
 HREF="idl_ang2vec.htm">ang2vec</A>
<strong> Top:</strong> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.80, 2021-06-22
</ADDRESS>
</BODY>
</HTML>
