<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>map2alm*</TITLE>
<META NAME="description" CONTENT="map2alm*">
<META NAME="keywords" CONTENT="subroutines">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="subroutines.css">

<LINK REL="next" HREF="subroutinesnode47.htm">
<LINK REL="previous" HREF="subroutinesnode45.htm">
<LINK REL="up" HREF="subroutines.htm">
<LINK REL="next" HREF="subroutinesnode47.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html831"
  HREF="subroutinesnode45.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html837"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html841"
  HREF="subroutinesnode47.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html839"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html832"
  HREF="subroutinesnode45.htm">long_count,&nbsp;long_size</A>

<B>Up:</B> <A NAME="tex2html838"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html842"
  HREF="subroutinesnode47.htm">map2alm_iterative*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000460000000000000000"></A>
<A NAME="sub:map2alm"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">map2alm*</FONT></font></b><hr>
<H3>This routine is a wrapper to 5 internal routines:map2alm_sc,
map2alm_sc_pre, map2alm_pol, map2alm_pol_pre1,
map2alm_pol_pre2. These routines analyse a <b>HEALPix</b> <EM>RING ordered</EM> map and return
<SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB><SUP><I>T</I></SUP></SPAN> (and if specified <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB><SUP><I>E</I></SUP></SPAN> and <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB><SUP><I>B</I></SUP></SPAN>) values up to
the desired order in <SPAN CLASS="MATH"><I>l</I></SPAN> (maximum 3*<SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN>). The different
routines are called depending on what parameters are passed. Some
routines analyse with or without precomputed harmonics and some with
or without polarisation. </H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/845/tree/trunk/src/f90/mod/alm_tools.F90"><b>src/f90/mod/alm_tools.F90</b></a>&nbsp;  

<P>
<hr><h1>FORMAT </h1><blockquote><h3>call <FONT COLOR="#CC0000">map2alm*</FONT>(
<A HREF="#sub:map2alm:nsmax">nsmax</A>, <A HREF="#sub:map2alm:nlmax">nlmax</A>, <A HREF="#sub:map2alm:nmmax">nmmax</A>, <A HREF="#sub:map2alm:map_TQU">map_TQU</A>, <A HREF="#sub:map2alm:alm_TGC">alm_TGC</A>, <A HREF="#sub:map2alm:zbounds">zbounds</A>, <A HREF="#sub:map2alm:w8ring_TQU">w8ring_TQU</A>[, <A HREF="#sub:map2alm:plm">plm</A>]
)</h3></blockquote>

<P>
<hr><H1>ARGUMENTS</H1>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SPAN  CLASS="textbf">name&nbsp;&amp;&nbsp;dimensionality</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">kind</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">in/out</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SPAN  CLASS="textbf">description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>
nsmax<A NAME="sub:map2alm:nsmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the <SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN> value of the map to analyse.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>nlmax<A NAME="sub:map2alm:nlmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>l</I></SPAN> value for the analysis.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>nmmax<A NAME="sub:map2alm:nmmax"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>the maximum <SPAN CLASS="MATH"><I>m</I></SPAN> value for the analysis.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>map_TQU<A NAME="sub:map2alm:map_TQU"></A>(0:12*nsmax**2-1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>if only the temperature map is to be analyse, the map-array should be passed with this rank.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>map_TQU(0:12*nsmax**2-1, 1:3)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>if both temperature an polarisation maps are to be analysed, the map array should have this rank, where the second index is (1,2,3) corresponding to (T,Q,U).</TD>
</TR>
</TABLE>
<TABLE CELLPADDING=3 BORDER="1">
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>alm_TGC<A NAME="sub:map2alm:alm_TGC"></A>(1:p, 0:nlmax, 0:nmmax)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SPC/ DPC</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>OUT</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>The <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> values output from the analysis. p is 1 or 3 dependent on wether polarisation is included or not. In the former case, the first index is (1,2,3) corresponding to (T,E,B).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>zbounds<A NAME="sub:map2alm:zbounds"></A>(1:2)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>section of the map on which to perform the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>
                   analysis, expressed in terms of <!-- MATH
 $z=\sin({\rm latitude}) =
                   \cos(\theta).$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="219" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg87.png"
 ALT="$z=\sin({\rm latitude}) =
\cos(\theta).$"></SPAN> If zbounds(1)<SPAN CLASS="MATH">&lt;</SPAN>zbounds(2), the analysis is
                   performed <EM>on</EM> the strip zbounds(1)<SPAN CLASS="MATH">&lt;<I>z</I>&lt;</SPAN>zbounds(2); if not,
                   it is performed <EM>outside</EM> of the strip
                   zbounds(2)<SPAN CLASS="MATH">&lt;<I>z</I>&lt;</SPAN>zbounds(1).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>w8ring_TQU<A NAME="sub:map2alm:w8ring_TQU"></A>(1:2*nsmax, 1:p)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>ring weights for quadrature corrections. If ring weights are not used, this array should be 1 everywhere. p is 1 for a temperature analysis and 3 for (T,Q,U).</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SMALL CLASS="SMALL">plm(0:(nlmax+1)(nlmax+2)nsmax-1)</SMALL><A NAME="sub:map2alm:plm"></A>, OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>If this optional matrix is passed with this rank, precomputed <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg22.png"
 ALT="$P_{lm}(\theta)$"></SPAN> are used instead of recursion. Note that since version 2.20 this feature has become obsolete
because of algorithm optimizations.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200><SMALL CLASS="SMALL">plm(0:(nlmax+1)(nlmax+2)nsmax-1,1:3)</SMALL>, OPTIONAL</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=200>If this optional matrix is passed with this rank, precomputed <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg22.png"
 ALT="$P_{lm}(\theta)$"></SPAN> AND precomputed tensor harmonics are used instead of recursion.</TD>
</TR>
</TABLE>

<P>
<HR><H1>EXAMPLE:</H1> 
<tt>use <A HREF="subroutinesnode41.htm#sub:healpix_types">healpix_types</A>
<BR>
use alm_tools
<BR>
use pix_tools
<BR>
integer(<A HREF="subroutinesnode41.htm#sub:healpix_types">i4b</A>) :: nside, lmax 
<BR>
real(<A HREF="subroutinesnode41.htm#sub:healpix_types">dp</A>), allocatable, dimension(:,:) :: dw8 
<BR>
real(dp), dimension(2) :: z 
<BR>
real(<A HREF="subroutinesnode41.htm#sub:healpix_types">sp</A>), allocatable, dimension(:,:) :: map 
<BR>
complex(<A HREF="subroutinesnode41.htm#sub:healpix_types">spc</A>), allocatable, dimension(:,:,:) :: alm 
<BR>
<BR>
nside = 256 
<BR>
lmax = 512 
<BR>
allocate(dw8(1:2*nside, 1:3)) 
<BR>
allocate(map(0:nside2npix(nside)-1,1:3)) 
<BR>
allocate(alm(1:3, 0:lmax, 0:lmax)
<BR>
dw8 = 1.0_dp 
<BR>
z = sin(10.0_dp * <A HREF="subroutinesnode41.htm#sub:healpix_types">DEG2RAD</A>) 
<BR>
call map2alm(nside, lmax, lmax, map, alm, (<SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg14.png"
 ALT="$\backslash$"></SPAN> z, -z <SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg14.png"
 ALT="$\backslash$"></SPAN>) , dw8, plm(0:(lmax+1)*(lmax+2)*nside-1))  
<BR></tt>
<blockquote>
Analyses temperature and polarisation maps passed in map. The map has
an <SPAN CLASS="MATH"><I>N</I><SUB><I>side</I></SUB></SPAN> of 256, and the analysis is performed up
to 512 in <SPAN CLASS="MATH"><I>l</I></SPAN> and m. The resulting <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients for
temperature and polarisation are returned in alm. A <SPAN CLASS="MATH"><IMG
 WIDTH="31" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="subroutinesimg88.png"
 ALT="$10^\circ$"></SPAN> cut on
each side of the equator is applied. Uniform weights are used. Since
the optional plm array is provided with rank one, precomputed scalar <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg22.png"
 ALT="$P_{lm}(\theta)$"></SPAN> are
used while tensor harmonics are computed with a recursion.
</blockquote>

<P>
<hr><H1>MODULES & ROUTINES</H1><H3>This section lists the modules and routines used by <FONT COLOR="#CC0000">map2alm*</FONT>.</h3>
  <DL COMPACT><DT>
<B>ring_analysis</B>
<DD>Performs FFT for the ring analysis.
  <DT>
<B><SPAN  CLASS="textbf">misc_util</SPAN></B>
<DD>module, containing:
  <DT>
<B><A HREF="subroutinesnode15.htm#sub:assert">assert_alloc</A></B>
<DD>routine to print error message when an array is not
  properly allocated		
  </DL>
Note: Starting with <A HREF="subroutinesnode4.htm#sub:new2p20">version 2.20</A>, <TT>libpsht</TT> routines will be called when
precomputed <SPAN CLASS="MATH"><I>P</I><SUB><I>lm</I></SUB></SPAN> are not provided.

<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">map2alm*</FONT></b></h3>
 
  <DL COMPACT><DT>
<B>anafast</B>
<DD>executable using <FONT COLOR="#CC0000">map2alm*</FONT> to analyse maps.
  <DT>
<B><A HREF="subroutinesnode8.htm#sub:alm2map">alm2map</A></B>
<DD>routine performing the inverse transform
of <FONT COLOR="#CC0000">map2alm*</FONT>.
  <DT>
<B><A HREF="subroutinesnode27.htm#sub:dump_alms">dump_alms</A></B>
<DD>write <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients
computed by <FONT COLOR="#CC0000">map2alm*</FONT> into a FITS file
  <DT>
<B><A HREF="subroutinesnode47.htm#sub:map2alm_iterative">map2alm_iterative</A></B>
<DD>similar to
<FONT COLOR="#CC0000">map2alm*</FONT> with iterative scheme.
  </DL>

<P>

<P>


<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html831"
  HREF="subroutinesnode45.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html837"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html841"
  HREF="subroutinesnode47.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html839"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html832"
  HREF="subroutinesnode45.htm">long_count,&nbsp;long_size</A>

<B>Up:</B> <A NAME="tex2html838"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html842"
  HREF="subroutinesnode47.htm">map2alm_iterative*</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
