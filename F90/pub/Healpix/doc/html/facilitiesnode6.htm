<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>anafast</TITLE>
<META NAME="description" CONTENT="anafast">
<META NAME="keywords" CONTENT="facilities">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="facilities.css">

<LINK REL="next" HREF="facilitiesnode7.htm">
<LINK REL="previous" HREF="facilitiesnode5.htm">
<LINK REL="up" HREF="facilities.htm">
<LINK REL="next" HREF="facilitiesnode7.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html153"
  HREF="facilitiesnode5.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html159"
  HREF="facilities.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html163"
  HREF="facilitiesnode7.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html161"
  HREF="facilitiesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html154"
  HREF="facilitiesnode5.htm">alteralm</A>

<B>Up:</B> <A NAME="tex2html160"
  HREF="facilities.htm">HEALPix/F90 facilities</A>

<B> Next:</B> <A NAME="tex2html164"
  HREF="facilitiesnode7.htm">hotspot</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00060000000000000000"></A>
<A NAME="fac:anafast"></A>
<BR>
 
</H1>
<P>
<b><font size=+6><FONT COLOR="#CC0000">anafast</FONT></font></b><hr>
<H3>This program performs harmonic analysis of the <b>HEALPix</b> maps 
up to a user
specified maximum spherical harmonic order <SPAN CLASS="MATH"><I>l</I><SUB><I>max</I></SUB></SPAN>.
The integrals are computed on the whole sphere, unless the user 
chooses  a provided option 
to excise from the input map(s) a simple, constant latitude, symmetric cut, and/or
apply an arbitray cut read from an external file.
Scalar, or scalar and tensor, spherical harmonic coefficients are evaluated
from the map(s) if the input provides, respectively, only the temperature,
or temperature and polarisation maps.
The total operation count scales as 
<!-- MATH
 ${\cal {O}}(N_{\rm pix}^{3/2} )$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="73" HEIGHT="47" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg7.png"
 ALT="${\cal {O}}(N_{\rm pix}^{3/2} )$"></SPAN> with a prefactor
depending on <SPAN CLASS="MATH"><I>l</I><SUB><I>max</I></SUB></SPAN>. 
<BR>Anafast reads one (two) file(s) containing the map(s) and produces 
a file containing the temperature auto- (or cross-) power spectrum
<SPAN CLASS="MATH"><I>C</I><SUP><I>TT</I></SUP><SUB><I>l</I></SUB></SPAN> and, if requested, 
also the polarisation power spectra <SPAN CLASS="MATH"><I>C</I><SUP><I>EE</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>BB</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>TE</I></SUP><SUB><I>l</I></SUB></SPAN>,
<SPAN CLASS="MATH"><I>C</I><SUP><I>TB</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>EB</I></SUP><SUB><I>l</I></SUB></SPAN> (as well as  <SPAN CLASS="MATH"><I>C</I><SUP><I>ET</I></SUP><SUB><I>l</I></SUB></SPAN>,
<SPAN CLASS="MATH"><I>C</I><SUP><I>BT</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>BE</I></SUP><SUB><I>l</I></SUB></SPAN> if two maps are provided).
The <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients computed during the execution also can be  
written to a (two) file(s) if requested. 
<BR>Anafast executes an approximate, discrete point-set quadrature on 
a sphere
sampled at the <b>HEALPix</b> pixel centers.
Spherical harmonic transforms are computed 
using recurrence relations for Legendre polynomials on co-latitude, 
<SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="20" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg8.png"
 ALT="$\theta$"></SPAN>, 
and  Fast Fourier Transforms on longitude, <SPAN CLASS="MATH"><IMG
 WIDTH="16" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg9.png"
 ALT="$\phi$"></SPAN>. 
<BR>
Anafast is provided with an option to use precomputed Legendre Polynomials;
please note that since version 2.20 this will most likely reduce performance
instead of increasing it. 
<BR>
Anafast permits two execution options 
which allow a significant improvement of accuracy of 
the approximate quadrature performed by this facility:
<BR><SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg10.png"
 ALT="$\bullet$"></SPAN> An improved analysis using the provided ring weights, 
which correct the quadrature
on latitude, and/or  
<BR><SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg10.png"
 ALT="$\bullet$"></SPAN> An iterative scheme using in 
succession several backward and forward harmonic transforms 
of the maps.</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/845/tree/trunk/src/f90/anafast/anafast.f90"><b>src/f90/anafast/anafast.f90</b></a>&nbsp;  
<P>
<hr> 
<H1>RECOMMENDATIONS FOR USERS</H1> 
<blockquote>
Execution of <FONT COLOR="#CC0000">anafast</FONT> requires a user to specify the maximum 
spherical harmonic order <SPAN CLASS="MATH"><I>l</I><SUB><I>max</I></SUB></SPAN> up to which the harmonic 
decomposition of the input maps will be performed.
Since there are no formal limits on parameter
<SPAN CLASS="MATH"><I>l</I><SUB><I>max</I></SUB></SPAN> enforced by <FONT COLOR="#CC0000">anafast</FONT>, the user should make his/her choices
judiciously. 
Hereafter it is convenient to specify <SPAN CLASS="MATH"><I>l</I><SUB><I>max</I></SUB></SPAN> 
in terms of the <b>HEALPix</b> 
map resolution parameter <SPAN CLASS="MATH"><I>nsmax</I></SPAN>.
<br><br>If the function to be analysed is strictly  band-width
limited, or nearly band-width limited (as in the case of 
a Gaussian beam smoothed signal discretized at a rate of a few pixels
per beam area), it is  sufficient to run <FONT COLOR="#CC0000">anafast</FONT> with
<!-- MATH
 $l_{max} \approx 2\cdot nsmax$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="143" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg11.png"
 ALT="$l_{max} \approx 2\cdot nsmax$"></SPAN>, with a very good <SPAN CLASS="MATH"><I>C</I><SUB><I>l</I></SUB></SPAN> 
error performance 
already in the raw (i.e. uncorrected quadrature) harmonic transform mode. 
If quadrature 
corrections are still desired in this case, it should be sufficient to use, at no
extra cost in execution time, the ring-weighted quadrature scheme. 
This is the recommended mode of operation of <FONT COLOR="#CC0000">anafast</FONT> for essentially
error and worry free typical applications, e.g. CPU-intensive 
Monte Carlo studies. 
<br><br>If more aggressive attempts are undertaken to extract from a map 
the spectral coefficients at <!-- MATH
 $l> 2\cdot nsmax$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="116" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg12.png"
 ALT="$l&gt; 2\cdot nsmax$"></SPAN> (for example, as 
in a possible case of an attempt to analyse an existing map, which was 
irreversibly binned  at a suboptimal resolution) 
the following should be kept in mind:
<br><br><SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg10.png"
 ALT="$\bullet$"></SPAN> Spherical harmonics discretized using <b>HEALPix</b> 
(either sampled at
pixel centers, or avaraged over pixel areas) form a linearly independent
system up to <!-- MATH
 $l_{max} = 3 \cdot nsmax -1$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="175" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg13.png"
 ALT="$l_{max} = 3 \cdot nsmax -1$"></SPAN>. Hence, the functions which are
strictly band-width limited to <!-- MATH
 $l_{max} = 3 \cdot nsmax - 1$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="175" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg13.png"
 ALT="$l_{max} = 3 \cdot nsmax -1$"></SPAN> 
can be fully
spectrally resolved with <FONT COLOR="#CC0000">anafast</FONT>, albeit with integration errors
in the uncorrected quadrature mode, which grow up to 
<!-- MATH
 $\delta C_l\propto \epsilon \cdot C_l$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="97" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg14.png"
 ALT="$ \delta C_l\propto \epsilon \cdot C_l$"></SPAN>, with <SPAN CLASS="MATH"><IMG
 WIDTH="61" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg15.png"
 ALT="$\epsilon &lt;0.1$"></SPAN>, 
at the highest values of <SPAN CLASS="MATH"><I>l</I></SPAN>. These integration  errors 
can be efficiently 
reduced
using <FONT COLOR="#CC0000">anafast</FONT> in the iterative mode. Although this <SPAN CLASS="MATH"><I>l</I><SUB><I>max</I></SUB></SPAN> range
-- <!-- MATH
 $2 \cdot nsmax < l_{max} < 3 \cdot nsmax - 1$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="281" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg16.png"
 ALT="$2 \cdot nsmax &lt; l_{max} &lt; 3 \cdot nsmax - 1$"></SPAN> -- is easily
manageable with <FONT COLOR="#CC0000">anafast</FONT> used on strictly band-width limited functions,
it should be used with caution in basic and automated applications, e.g.
Monte Carlo simulations.
<br><br><SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg10.png"
 ALT="$\bullet$"></SPAN> As with any discrete Fourier transform, <FONT COLOR="#CC0000">anafast</FONT> application to
functions which are not band-width limited results with aliasing
of power, which can not be remedied. If the particular case of interest
may result in such a band-width violation (i.e. there is significant power
in the function at <!-- MATH
 $l> 3 \cdot nsmax -1$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="148" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg17.png"
 ALT="$l&gt; 3 \cdot nsmax -1$"></SPAN>), the function should
be smoothed before the application of <FONT COLOR="#CC0000">anafast</FONT>, or discretized and
then analysed, on a refined <b>HEALPix</b> grid (with larger <SPAN CLASS="MATH"><I>nsmax</I></SPAN>).
<br><br><SPAN CLASS="MATH"><IMG
 WIDTH="14" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg10.png"
 ALT="$\bullet$"></SPAN> REMEMBER: 
A peculiar property of the sphere, which usually surprizes those 
whose intuition is built on experience with FFTs on a segment, or 
on a Euclidean multidimensional domains, is the lack of 
a regular and uniform point-set at arbitrary resolution, 
and the resulting non-commutativity of the forward and
backward discrete Fourier transforms on nearly-uniform point-sets,
e.g. <b>HEALPix</b> . Hence,
as in any case of attempting an extreme application of an off-the-shelf
software, use caution and understand your problem well <I>before</I>
executing <FONT COLOR="#CC0000">anafast</FONT> under such cicumstances!

</blockquote>
<P>
<hr><h1>FORMAT </h1><blockquote><h3>%
anafast [options] [parameter_file]
</h3></blockquote>
<P>
<hr><H1>COMMAND LINE OPTIONS</H1> 
  </SMALL><DL COMPACT><DT>
<B><TT>-d</TT></B>
<DD><DT>
<B><TT>--double</TT></B>
<DD>double precision mode (see Notes on double/single precision modes on page&nbsp;<A HREF="facilitiesnode2.htm#page:ioprec"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>)
    <DT>
<B><TT>-s</TT></B>
<DD><DT>
<B><TT>--single</TT></B>
<DD>single precision mode (default)
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr>
<H1>QUALIFIERS</H1>
 
  </SMALL><DL COMPACT><DT>
<B>infile = </B>
<DD><A NAME="fac:anafast:infile"></A>Defines the input map file. 
	(default= map.fits)
	If not blank, the filename should <EM>never</EM> be put between quotes even if it contains
symbols such as <TT>&amp;, [, ], ?, =</TT> which should be typed literally (ie, unprotected). For instance
 <TT>infile&nbsp;=&nbsp;http://site/action?file.fits[2][col FLUX]</TT> is just fine.
    <DT>
<B>infile2 = </B>
<DD><A NAME="fac:anafast:infile2"></A>Defines the 2nd input map file, to be cross-correlated with
	the first one. The 2 maps should match in resolution (<SPAN CLASS="MATH"><I>nsmax</I></SPAN>) and coordinate.
	(default= `', only the auto-correlation of the first map will be computed)
    <DT>
<B>outfile = </B>
<DD><A NAME="fac:anafast:outfile"></A>Defines the output file with the power spectrum. If only
      one input map is provided, <TT>outfile</TT> will contains its auto-spectra,
      if 2 maps are provided, <TT>outfile</TT> will contain their
      cross-spectra. Note in particular that in the latter case, the <!-- MATH
 $C^{T\times E}_l$
 -->
<SPAN CLASS="MATH"><I>C</I><SUP><I>T</I> x <I>E</I></SUP><SUB><I>l</I></SUB></SPAN> power
      spectrum will be build from the <SPAN CLASS="MATH"><I>T</I></SPAN> field of the 1st (possibly polarized) map, and the <SPAN CLASS="MATH"><I>E</I></SPAN>
      field of the second polarized map.
(default= cl_out.fits)
     <DT>
<B>simul_type = </B>
<DD><A NAME="fac:anafast:simul_type"></A>Defines which map(s) to analyse, 1=temperature only, 2=temperature AND polarisation.
(default= 1)
     <DT>
<B>nlmax = </B>
<DD><A NAME="fac:anafast:nlmax"></A>Defines the maximum <SPAN CLASS="MATH"><I>l</I></SPAN> value 
to be used. See the Recommendations for Users. 
(default= 64)
 <DT>
<B>maskfile = </B>
<DD><A NAME="fac:anafast:maskfile"></A>Defines the FITS file containing the pixel mask(s) or
 weighting scheme(s) by which the map(s) read from <TT>infile</TT> will be
 multiplied before analysis. If the file contains several fields, the first
one in which at least one pixel is non-zero will be used. This option can be
 used to, for instance, apply
the WMAP Kp intensity mask to the data (see
<A NAME="tex2html13"
  HREF="http://lambda.gsfc.nasa.gov">http://lambda.gsfc.nasa.gov</A>
), but it will <EM>not</EM> handle the WMAP composite mask correctly.
Can be used in conjonction with <TT>theta_cut_deg</TT>. Masked or weighted pixels
 will be correctly accounted when performing the monopole and dipole regression.
<BR><EM>Note:</EM> The mask's resolution (<SPAN CLASS="MATH"><I>nsmax</I></SPAN>) and ordering can be different from the input map(s)
one's, and the mask will be pro/down-graded and reordered to match the map. On the
other hand, the mask and maps coordinates will always be presumed to match (ie, no
attempt of rotation of the mask will be made).
(default= `': no mask, all valid pixels are used)
 <DT>
<B>theta_cut_deg = </B>
<DD><A NAME="fac:anafast:theta_cut_deg"></A>Defines the latitude (in degrees) of 
an optional, straight symmetric cut around the equator.  Pixels located within
that cut (<SPAN CLASS="MATH">|b|&lt;</SPAN><TT>theta_cut_deg</TT> are ignored.
(default= <SPAN CLASS="MATH"><IMG
 WIDTH="21" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="facilitiesimg18.png"
 ALT="$0^\circ$"></SPAN>: no cut)
 <DT>
<B>iter_order = </B>
<DD><A NAME="fac:anafast:iter_order"></A>Defines the maximum order of quadrature 
iteration to be used. (default=0, no iteration)
 <DT>
<B>outfile_alms = </B>
<DD><A NAME="fac:anafast:outfile_alms"></A>Defines the name of the file 
containing the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients of the first map
which can be written optionally.   (default= no entry --
<SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>s are not written to a file)
 <DT>
<B>outfile_alms2 = </B>
<DD><A NAME="fac:anafast:outfile_alms2"></A>Defines the name of the file 
containing the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients of the second map, if any,
which can be written optionally.   (default= no entry --
<SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>s are not written to a file)
 <DT>
<B>plmfile = </B>
<DD><A NAME="fac:anafast:plmfile"></A>Defines the name for an input file
    containing  precomputed Legendre polynomials <SPAN CLASS="MATH"><I>P</I><SUB><I>lm</I></SUB></SPAN>.
(default= no entry -- <FONT COLOR="#CC0000">anafast</FONT> executes the recursive evaluation 
of <SPAN CLASS="MATH"><I>P</I><SUB><I>lm</I></SUB></SPAN>s)
<DT>
<B>w8file = </B>
<DD><A NAME="fac:anafast:w8file"></A>Defines name for an input file containing ring
  weights in the improved quadrature mode (default= no entry --
the name is assumed to be 'weight_ring_n0xxxx.fits' where xxxx is nsmax)
<DT>
<B>w8filedir = </B>
<DD><A NAME="fac:anafast:w8filedir"></A>Gives the directory where the ring weight files are
to be found (default= no entry -- <FONT COLOR="#CC0000">anafast</FONT> searches the default
directories, see introduction)
<DT>
<B>won = </B>
<DD><A NAME="fac:anafast:won"></A>Set this to 1 if ring weight files are to be used,
otherwise set it to 0 (or 2). (default= 0)
<DT>
<B>regression = </B>
<DD><A NAME="fac:anafast:regression"></A>Sets the degree of the regression made on the
input map before doing the power spectrum analysis. 
The regression is a minimal variance fit (assuming a uniform noise) 
made on valid (unflagged and unmasked) pixels, out of the symmetric cut (if
any). In case of cut sky analysis, such a regression reduces the monopole
and dipole leakage to higher <SPAN CLASS="MATH"><I>l</I></SPAN>'s.
<BR>
0 : no regression, does the a_lm analysis on the raw map
<BR>
1 : removes the best fit monopole first
<BR>
2 : removes the best fit monopole and dipole first
<BR>
default = 0.

<P>
</DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr> 
<H1>DESCRIPTION</H1> 
<blockquote>
Anafast reads one or two binary FITS-files containing a <b>HEALPix</b> map. These
files can each contain
a temperature map or both temperature and polarisation (Q,U) maps. Anafast analyses
the map(s) and makes an output ascii-FITS file containing the angular auto or cross
power spectra <SPAN CLASS="MATH"><I>C</I><SUP><I>TT</I></SUP><SUB><I>l</I></SUB></SPAN>s
(and <SPAN CLASS="MATH"><I>C</I><SUP><I>EE</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>BB</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>TE</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>TB</I></SUP><SUB><I>l</I></SUB></SPAN> and <SPAN CLASS="MATH"><I>C</I><SUP><I>EB</I></SUP><SUB><I>l</I></SUB></SPAN> if specified, as well
as <SPAN CLASS="MATH"><I>C</I><SUP><I>ET</I></SUP><SUB><I>l</I></SUB></SPAN>, <SPAN CLASS="MATH"><I>C</I><SUP><I>BT</I></SUP><SUB><I>l</I></SUB></SPAN> and <SPAN CLASS="MATH"><I>C</I><SUP><I>BE</I></SUP><SUB><I>l</I></SUB></SPAN> if two maps are provided). 
Here <SPAN CLASS="MATH"><I>C</I><SUP><I>TE</I></SUP><SUB><I>l</I></SUB></SPAN> is meant as the power
spectrum built from the <SPAN CLASS="MATH"><I>T</I></SPAN> field of the first (polarized) map, and the <SPAN CLASS="MATH"><I>E</I></SPAN>
field of the second polarized map, while it is the other way around for <SPAN CLASS="MATH"><I>C</I><SUP><I>ET</I></SUP><SUB><I>l</I></SUB></SPAN>.
Anafast produces <SPAN CLASS="MATH"><I>C</I><SUB><I>l</I></SUB></SPAN>s up to a specified maximum <SPAN CLASS="MATH"><I>l</I></SPAN>-value
(see Recommendations for Users). 
If requested, the computed <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> coefficients 
can  be written to a FITS file. This file can be used in the 
constrained realisation mode  of  <A HREF="facilitiesnode14.htm#fac:synfast">synfast</A>. 
<br><br>Anafast permits two execution modes that allow to improve 
the quadrature accuracy: 
(1) the  ring weight corrected quadrature, and
(2)  the  iterative scheme. 
Using the ring weights does not increase the execution time.  
The precomputed ring weights to be used for each 
<b>HEALPix</b> resolution <SPAN CLASS="MATH"><I>nsmax</I></SPAN> are provided in
the <TT>$HEALPIX/data</TT> directory. 
The more sophisticated iterative scheme increases the
accuracy more effectively than the weighted ring scheme,
but its disadvantage is that the time for the analysis
increases, 1 iteration takes 3 times as long, 2 iterations 5 times as
long on so forth, since each order of iteration requires one more forward
and backward transform. 
<br><br>The spherical harmonics evaluation uses  a
recurrence on associated Legendre polynomials <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg19.png"
 ALT="$P_{lm}(\theta)$"></SPAN>. 
This recurrence consumed most of the CPU time used by <FONT COLOR="#CC0000">anafast</FONT> up to version
2.15. We have therefore included an option to load precomputed values for the
<!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg19.png"
 ALT="$P_{lm}(\theta)$"></SPAN> from a file generated by the <b>HEALPix</b> facility
<A HREF="facilitiesnode10.htm#fac:plmgen">plmgen</A>. Since the introduction of accelerated spherical
harmonic transforms in <b>HEALPix</b> v2.20, this feature is obsolete and should no
longer be used. 

</blockquote>
<P>
<hr><H1>DATASETS</H1>
<h3>The following datasets are involved in the <b><FONT COLOR="#CC0000">anafast</FONT></b>
 processing.</h3>

</SMALL><TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SMALL CLASS="FOOTNOTESIZE">  
  <SPAN  CLASS="textbf">Dataset</SPAN> </SMALL></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE"> <SPAN  CLASS="textbf">Description</SPAN> </SMALL></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SMALL CLASS="FOOTNOTESIZE">  
                   </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE">                      </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SMALL CLASS="FOOTNOTESIZE">  
data/weight_ring_n0xxxx.fits </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE"> Files containing ring weights
                   for the <FONT COLOR="#CC0000">anafast</FONT> improved quadrature mode.</SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SMALL CLASS="FOOTNOTESIZE">  
                   </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE">                      </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SMALL CLASS="FOOTNOTESIZE">   
</SMALL></TD>
<TD></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"> 

<P>
<hr><H1>SUPPORT    </H1><H3>This section lists those routines and facilities (including those <i>external</i> to the <b>HEALPix</b> distribution) which can assist in the utilisation of <b><FONT COLOR="#CC0000">anafast</FONT></b>.</H3>
  </SMALL><DL COMPACT><DT>
<B><A HREF="facilitiesnode14.htm#fac:synfast">synfast</A></B>
<DD>This <b>HEALPix</b> facility can generate a map for analysis by <FONT COLOR="#CC0000">anafast</FONT>.
  <DT>
<B><A HREF="facilitiesnode5.htm#fac:alteralm">alteralm</A></B>
<DD>This <b>HEALPix</b> Fortran facility can be
  used to modify the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> extracted by <FONT COLOR="#CC0000">anafast</FONT> before they are used as
  constraints on a <A HREF="facilitiesnode14.htm#fac:synfast">synfast</A> run.
  <DT>
<B><A HREF="facilitiesnode10.htm#fac:plmgen">plmgen</A></B>
<DD>This <b>HEALPix</b> facility can be used to generate precomputed Legendre polynomials.		
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr><H1>EXAMPLE # 1:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> anafast  </SMALL></TD>
<TD></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>
Anafast runs in interactive mode -- self-explanatory.
</blockquote>
<P>

<P>
<hr><H1>EXAMPLE # 2:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> anafast  filename </SMALL></TD>
<TD></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>When 'filename' is present, <FONT COLOR="#CC0000">anafast</FONT> enters the non-interactive mode and parses
its inputs from the file 'filename'. This has the following
structure: the first entry is a qualifier which announces to the parser
which input immediately follows. If this input is omitted in the
input file, the parser assumes the default value.
If the equality sign is omitted, then the parser ignores the entry.
In this way comments may also be included in the file.
In this example, the file contains the following qualifiers:
<BR>
<tt><A HREF="#fac:anafast:simul_type">simul_type</A>= 1</tt><br>
<tt><A HREF="#fac:anafast:nlmax">nlmax</A>= 64</tt><br>
<tt><A HREF="#fac:anafast:theta_cut_deg">theta_cut_deg</A>= 0</tt><br>
<tt><A HREF="#fac:anafast:iter_order">iter_order</A>= 0</tt><br>
<tt><A HREF="#fac:anafast:infile">infile</A>= map.fits</tt><br>
<tt><A HREF="#fac:anafast:outfile">outfile</A>= cl_out.fits</tt><br>
<tt><A HREF="#fac:anafast:regression">regression</A>= 0</tt><br>
Anafast reads the map from <EM>map.fits</EM>, makes an analysis and produces <SPAN CLASS="MATH"><I>C</I><SUP><I>T</I></SUP><SUB><I>l</I></SUB></SPAN>s up to l=64.
This powerspectrum is saved in the file <EM>cl_out.fits</EM>. 
No galactic cut is excised and no iterations are performed.
As <A HREF="#fac:anafast:regression">regression</A>is set to 0 (its default value) the map is analyzed as
is, without prior best fit removal of the monopole nor the dipole.
</SMALL>
<P>
<SMALL CLASS="FOOTNOTESIZE">Since
<BR>
<tt><A HREF="#fac:anafast:infile2">infile2</A></tt><br>
<tt><A HREF="#fac:anafast:outfile_alms">outfile_alms</A></tt><br>
<tt><A HREF="#fac:anafast:outfile_alms2">outfile_alms2</A></tt><br>
<tt><A HREF="#fac:anafast:w8file">w8file</A></tt><br>
<tt><A HREF="#fac:anafast:w8filedir">w8filedir</A></tt><br>
<tt><A HREF="#fac:anafast:plmfile">plmfile</A></tt><br>
<tt><A HREF="#fac:anafast:maskfile">maskfile</A></tt><br>
were omitted, they take their default values (empty strings). 
This means that no file for precomputed
Legendre polynomials is read, no second map is read, no mask is applied, and <FONT COLOR="#CC0000">anafast</FONT> does not save the <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN> values
from the analysis.
</SMALL>
<P>
<SMALL CLASS="FOOTNOTESIZE">Also since
<BR>
<tt><A HREF="#fac:anafast:won">won</A></tt><br>
is not given, it takes it default value 2, which means that ring
weights are not used.
</SMALL>
<P>
<SMALL CLASS="FOOTNOTESIZE"></blockquote>
<P>
<hr><H1>RELEASE NOTES</H1><blockquote>
  </SMALL><DL COMPACT><DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Initial release (<b>HEALPix</b> 0.90)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Optional non-interactive operation. Proper FITS file
    support. Improved reccurence algorithm for <!-- MATH
 $P_{lm}(\theta)$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="57" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="facilitiesimg19.png"
 ALT="$P_{lm}(\theta)$"></SPAN> which can compute to higher <SPAN CLASS="MATH"><I>l</I></SPAN> values. New functionality: arbitrary order of iterations, precomputed
    <SPAN CLASS="MATH"><I>P</I><SUB><I>lm</I></SUB></SPAN>, dumping of <SPAN CLASS="MATH"><I>a</I><SUB><I>lm</I></SUB></SPAN>. (<b>HEALPix</b> 1.00)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 New functionality: possibility of removing the best fit monopole
    and dipole. New Parser. Can be linked to FFTW (<b>HEALPix</b> 1.20)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 New functionality: addition of <TT>maskfile</TT> (<b>HEALPix</b> 2.0)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Bug correction: correct interaction of iterative scheme with masked pixels (<b>HEALPix</b> 2.01)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 New functionality: cross-correlation of 2 maps; Correction of this documentation: the code expects <TT>maskfile</TT> and
not <TT>mask_file</TT>  (<b>HEALPix</b> 2.1)
    <DT><DD><IMG WIDTH="14" HEIGHT="14" SRC="blueball.png" ALT="*">
 Bug correction: now correctly supports mask pro/down-grading
  </DL><SMALL CLASS="FOOTNOTESIZE">
</blockquote>
<P>
<hr><H1>MESSAGES</H1><h3>This section describes error messages generated by <b><FONT COLOR="#CC0000">anafast</FONT></b>
</h3>

</SMALL><TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=125><SMALL CLASS="FOOTNOTESIZE">  
  <SPAN  CLASS="textbf">Message</SPAN> </SMALL></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SMALL CLASS="FOOTNOTESIZE"> <SPAN  CLASS="textbf">Severity</SPAN> </SMALL></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE"> <SPAN  CLASS="textbf">Text</SPAN> </SMALL></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125><SMALL CLASS="FOOTNOTESIZE">  
                   </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SMALL CLASS="FOOTNOTESIZE">                   </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE">   </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125><SMALL CLASS="FOOTNOTESIZE">  
can not allocate memory for array xxx </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SMALL CLASS="FOOTNOTESIZE">  Fatal </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE"> You do not have
                   sufficient system resources to run this
                   facility at the map resolution you required. 
  Try a lower map resolution.  </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125><SMALL CLASS="FOOTNOTESIZE">  
                   </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=50><SMALL CLASS="FOOTNOTESIZE">                   </SMALL></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SMALL CLASS="FOOTNOTESIZE">   </SMALL></TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=125><SMALL CLASS="FOOTNOTESIZE">   
</SMALL></TD>
<TD></TD>
<TD></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"> 
<SMALL CLASS="FOOTNOTESIZE">

</SMALL>
<P>

<P>
<SMALL CLASS="FOOTNOTESIZE">
 </SMALL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html153"
  HREF="facilitiesnode5.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html159"
  HREF="facilities.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html163"
  HREF="facilitiesnode7.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html161"
  HREF="facilitiesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html154"
  HREF="facilitiesnode5.htm">alteralm</A>

<B>Up:</B> <A NAME="tex2html160"
  HREF="facilities.htm">HEALPix/F90 facilities</A>

<B> Next:</B> <A NAME="tex2html164"
  HREF="facilitiesnode7.htm">hotspot</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
