<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Healpix C++: HEALPix C++ facilities</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="facilities">HEALPix C++ facilities </a></h1><h2><a class="anchor" name="syn_alm_cxx">
syn_alm_cxx</a></h2>
This program reads a set of <img class="formulaInl" alt="$C_l$" src="form_2.png"> from disk and converts it to a set of <img class="formulaInl" alt="$a_{lm}$" src="form_3.png">.<p>
<div class="fragment"><pre class="fragment">Parameters read by syn_alm_cxx:

nlmax (integer):
  maximum order of l

nmmax (integer):
  maximum order of m (must not be larger than nlmax, default=nlmax)

infile (string):
  input file containing the CMB power spectrum

outfile (string):
  output file name for the calculated a_lm

rand_seed (integer):
  random-number seed

fwhm_arcmin (real):
  FWHM (in arcmin) of a Gaussian beam, which is used to smooth the
  resulting sky a_lm (default=0)

polarisation (bool):
  if false, only the intensity a_lm are generated,
  if true, T, G and C a_lm are generated

if (polarisation)
  full_ps (bool, default=false):
    if false, only TT, GG, CC and TG components of the spectrum are used
    if true, also TC and GC components are used
endif

double_precision (bool, default=false):
  if false, the a_lm are created in single precision,
  otherwise in double precision.
</pre></div><h2><a class="anchor" name="alm2map_cxx">
alm2map_cxx</a></h2>
This program reads a set of <img class="formulaInl" alt="$a_{lm}$" src="form_3.png"> from disk and converts them to a HEALPix map.<p>
<div class="fragment"><pre class="fragment">Parameters read by alm2map_cxx:

nlmax (integer):
  maximum order of l

nmmax (integer):
  maximum order of m (must not be larger than nlmax, default=nlmax)

infile (string):
  input file containing the a_lm

outfile (string):
  output file name for the Healpix map(s)

nside (integer):
  nside parameter for the output map(s)

polarisation (bool):
  if false, only the intensity map is generated,
  if true, maps for I, Q and U are generated

fwhm_arcmin (double, default=0):
  FWHM in arc minutes of a Gaussian beam, which is used to smooth
  the a_lm

pixel_window (bool, default=false):
  if true, the a_lm are multiplied by the appropriate pixel window function

if (pixel_window)
  healpix_data (string):
    directory containing the Healpix data files
endif

double_precision (bool, default=false):
  if false, a_lm and maps are read/written in single precision,
  otherwise in double precision.
</pre></div><h2><a class="anchor" name="anafast_cxx">
anafast_cxx</a></h2>
This program performs harmonic analysis of a HEALPix map up to a user-specified maximum spherical harmonic order <img class="formulaInl" alt="$l_{\mbox{max}}$" src="form_4.png">. The integrals are computed on the whole sphere. Scalar, or scalar and tensor, spherical harmonic coefficients are evaluated from the map(s) if the input provides, respectively, only the temperature, or temperature and polarisation maps. The total operation count scales as <img class="formulaInl" alt="${\cal {O}}(N_{\mbox{pix}}^{3/2})$" src="form_5.png"> with a prefactor depending on <img class="formulaInl" alt="$l_{\mbox{max}}$" src="form_4.png">.<p>
Anafast_cxx reads a file containing the map(s) and produces a file containing the temperature power spectrum <img class="formulaInl" alt="$C^T_l$" src="form_6.png"> and, if requested, also the polarisation power spectra <img class="formulaInl" alt="$C^E_l$" src="form_7.png">, <img class="formulaInl" alt="$C^B_l$" src="form_8.png"> and <img class="formulaInl" alt="$C^{T\times E}_l$" src="form_9.png">. The <img class="formulaInl" alt="$a_{lm}$" src="form_3.png"> coefficients computed during the execution also can be written to a file if requested.<p>
Anafast_cxx executes an approximate, discrete point-set quadrature on a sphere sampled at the HEALPix pixel centers. Spherical harmonic transforms are computed using recurrence relations for Legendre polynomials on co-latitude (<img class="formulaInl" alt="$\vartheta$" src="form_10.png">) and Fast Fourier transforms on longitude (<img class="formulaInl" alt="$\varphi$" src="form_11.png">).<p>
Anafast permits two execution options which allow a significant improvement of accuracy of the approximate quadrature performed by this facility:<p>
<ul>
<li>An improved analysis using the provided ring weights, which correct the quadrature on latitude, and/or</li><li>An iterative scheme using in succession several backward and forward harmonic transforms of the maps.</li></ul>
<p>
<div class="fragment"><pre class="fragment">Parameters read by anafast_cxx:

nlmax (integer):
  maximum order of l

nmmax (integer):
  maximum order of m (must not be larger than nlmax, default=nlmax)

infile (string):
  input file containing the Healpix map

outfile (string, default=""):
  output file name for power spectrum; if empty, no spectrum is written

outfile_alms (string, default=""):
  output file name for the a_lm; if empty, no a_lm are written

polarisation (bool):
  if false, only the intensity a_lm are generated,
  if true, a_lm for T, G and C component are generated

weighted (bool, default=false):
  if true, weighted quadrature is used

if (weighted)
  healpix_data (string):
    directory containing the Healpix data files
endif

iter_order (integer, default=0)
  number of iterations for the analysis (0: standard analysis)

double_precision (bool, default=false):
  if false, maps and a_lm are read/written in single precision,
  otherwise in double precision.

if (polarisation==true &amp;&amp; outfile!="")
  full_powerspectrum (bool, default=false):
    if true, write a 6-column power spectrum;
    if false, write a 4-column power spectrum.
endif

remove_monopole (bool, default=false):
  if true, subtract the average pixel value from the temperature map, and add
  the corresponding value to almT(0,0) after the map2alm transform.
</pre></div><h2><a class="anchor" name="map2tga">
map2tga</a></h2>
This program reads in a HEALPix sky map in FITS format and generates an image in TGA format. map2tga allows the selection of the projection scheme (Mollweide or Gnomonic for small patches of the sky), color table, color bar inclusion, linear or log scaling, maximum and minimum range for the plot and plot-title. The facility provides a command-line interface, but can also read a parameter file.<p>
<div class="fragment"><pre class="fragment">Usage:
  map2tga &lt;parameter file&gt;

or:
  map2tga &lt;input file&gt; &lt;output file&gt; [-sig &lt;int&gt;] [-pal &lt;int&gt;]
    [-xsz &lt;int&gt;] [-bar] [-log] [-asinh] [-lon &lt;float&gt;] [-lat &lt;float&gt;]
    [-mul &lt;float&gt;] [-add &lt;float&gt;] [-min &lt;float&gt;] [-max &lt;float&gt;]
    [-res &lt;float&gt;] [-title &lt;string&gt;] [-flippal] [-gnomonic]
    [-interpol] [-equalize] [-viewer &lt;viewer&gt;]


Parameters read by map2tga:

infile (string):
  input file containing the Healpix map

outfile (string):
  output TGA file

sig (integer, default=1):
  column number of the requested Healpix map

pal (integer, default=4):
  number of the color palette

flippal (bool, default=false):
  whether the palette should be flipped

xsz (integer, default=1024):
  number of image pixels in x direction

bar (logical, default=false):
  whether a color bar should be added to the image

log (logical, default=false):
  whether the logarithm of the map values should be displayed

equalize (logical, default=false):
  whether histogram equalisation should be performed

asinh (logical, default=false):
  whether the hyperbolic arcsine of the map values should be displayed

lon (double, default=0):
  the longitude (in degrees) of the image center

lat (double, default=0):
  the latitude (in degrees) of the image center

mul (double, default=1):
  scale factor applied to the data

add (double, default=0):
  offset added to the data (before multiplication)

min (double, optional):
  if specified, this value is used as minimum of the color scale

max (double, optional):
  if specified, this value is used as maximum of the color scale

res (double, default=1):
  only for gnomonic projection: the size (in arcmin) of an image pixel

title (string, optional):
  if specified, this value is used as the image title

viewer (string, optional):
  if specified, this executable is used to show the resulting image

pro (string, default="mollw"):
  if this is equal to "gno", gnomonic projection is used, else Mollweide

interpol (bool, default=false):
  false: no interpolation
  true : bilinear interpolation
</pre></div><h2><a class="anchor" name="rotalm_cxx">
rotalm_cxx</a></h2>
Performs a coordinate transformation on a set of <img class="formulaInl" alt="$a_{lm}$" src="form_3.png">.<p>
<div class="fragment"><pre class="fragment">
Usage: rotalm_cxx &lt;infile&gt; &lt;outfile&gt; &lt;itransform&gt; &lt;pol&gt;
Transform 1: Equatorial (2000) -&gt; Galactic   (2000)
          2: Galactic   (2000) -&gt; Equatorial (2000)
          3: Equatorial (2000) -&gt; Ecliptic   (2000)
          4: Ecliptic   (2000) -&gt; Equatorial (2000)
          5: Ecliptic   (2000) -&gt; Galactic   (2000)
          6: Galactic   (2000) -&gt; Ecliptic   (2000)
          7: Equatorial (1950) -&gt; Galactic   (1950)
          8: Galactic   (1950) -&gt; Equatorial (1950)
          9: Equatorial (1950) -&gt; Ecliptic   (1950)
         10: Ecliptic   (1950) -&gt; Equatorial (1950)
         11: Ecliptic   (1950) -&gt; Galactic   (1950)
         12: Galactic   (1950) -&gt; Ecliptic   (1950)
    </pre></div><h2><a class="anchor" name="mult_alm">
mult_alm</a></h2>
This program reads a set of (unpolarised or polarised) <img class="formulaInl" alt="$a_{lm}$" src="form_3.png">, removes pixel window functions and/or Gaussian beams, applies different pixel window functions or Gaussian beams, and outputs the result.<p>
<div class="fragment"><pre class="fragment">Parameters read by mult_alm:

infile (string):
  input file containing the a_lm

outfile (string):
  output file name for the calculated a_lm

fwhm_arcmin_in (real, default=0):
  FWHM (in arcmin) of a Gaussian beam, which will be _removed_ from the
  input a_lm

fwhm_arcmin_out (real, default=0):
  FWHM (in arcmin) of a Gaussian beam, which will be used to smoothe the
  output a_lm

nside_pixwin_in (integer, default=0):
  If this is different from 0, the corresponding pixel window function
  will be _removed_ from the input a_lm

nside_pixwin_out (integer, default=0):
  If this is different from 0, the corresponding pixel window function
  will be applied to the output a_lm

if ((nside_pixwin_in&gt;0)||(nside_pixwin_out&gt;0))
  healpix_data (string):
    directory containing the Healpix data files
endif

cl_in (string, default=""):
  if supplied, the power spectrum from this file will be _removed_
  from the input a_lm
  NOTE: currently only supported for unpolarised a_lm

cl_out (string, default=""):
  if supplied, the power pectrum from this file will be applied
  to the output a_lm
  NOTE: currently only supported for unpolarised a_lm

polarisation (bool):
  if false, only the intensity a_lm are generated,
  if true, T, G and C a_lm are generated

double_precision (bool, default=false):
  if false, the a_lm are read/written in single precision,
  otherwise in double precision.
</pre></div><h2><a class="anchor" name="smoothing_cxx">
smoothing_cxx</a></h2>
This program reads a (unpolarised or polarised) HEALPix map, converts it to <img class="formulaInl" alt="$a_{lm}$" src="form_3.png">, performs a smoothing operation with a Gaussian beam, converts the <img class="formulaInl" alt="$a_{lm}$" src="form_3.png"> back to a map and outputs the result.<p>
<div class="fragment"><pre class="fragment">Parameters read by smoothing_cxx:

fwhm_arcmin (double):
  FWHM (in arcmin) of the Gaussian beam used for smoothing. If the value
  is negative, the smoothing of a Gaussian beam with an FWHM of -fwhm_arcmin
  will be _removed_ from the input map.

nlmax (integer):
  maximum order of l

infile (string):
  input file containing the Healpix map

outfile (string, default=""):
  output file for the smoothed Healpix map

polarisation (bool):
  if false, only an intensity map is smoothed
  if true, an IQU map is smoothed

weighted (bool, default=false):
  if true, weighted quadrature is used

if (weighted)
  healpix_data (string):
    directory containing the Healpix data files
endif

iter_order (integer, default=0)
  number of iterations for the analysis (0: standard analysis)

double_precision (bool, default=false):
  if false, a_lm are read/written in single precision, otherwise in
  double precision.
</pre></div><h2><a class="anchor" name="calc_powspec">
calc_powspec</a></h2>
This program reads one or two sets of <img class="formulaInl" alt="$a_{lm}$" src="form_3.png">, extracts the (unpolarised or polarised) power spectrum or the unpolarised cross power spectrum, and outputs the result.<p>
<div class="fragment"><pre class="fragment">Usage: calc_powspec &lt;almfile1&gt; [&lt;almfile2&gt;] &lt;powspec_file&gt;</pre></div><h2><a class="anchor" name="median_filter_cxx">
median_filter_cxx</a></h2>
This program inputs a HEALPix map, runs a median filter with the desired radius on it and saves the result to another file.<p>
<div class="fragment"><pre class="fragment">Usage: median_filter_cxx &lt;input map&gt; &lt;output map&gt; &lt;radius in arcmin&gt;</pre></div> </div>
<hr><address style="align: right;"><small>
Generated on Fri Aug 26 12:54:45 2016 for Healpix C++
</a> </small></address>
</body>
</html>
