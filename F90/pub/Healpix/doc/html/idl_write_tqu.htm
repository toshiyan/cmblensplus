<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020 (Released January 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>write_tqu</TITLE>
<META NAME="description" CONTENT="write_tqu">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020">
<!--Begin favicon-->
   <link rel='apple-touch-icon' sizes='180x180' href='images/favicons/apple-touch-icon.png?v=2017'>
   <link rel='icon' type='image/png' sizes='32x32' href='images/favicons/favicon-32x32.png?v=2017'>
   <link rel='icon' type='image/png' sizes='16x16' href='images/favicons/favicon-16x16.png?v=2017'>
   <link rel='manifest' href='images/favicons/manifest.json?v=2017'>
   <link rel='mask-icon' href='images/favicons/safari-pinned-tab.svg?v=2017' color='#5bbad5'>
   <link rel='shortcut icon' href='images/favicons/favicon.ico?v=2017'>
   <meta name='apple-mobile-web-app-title' content='HEALPix'>
   <meta name='application-name' content='HEALPix'>
   <meta name='msapplication-config' content='images/favicons/browserconfig.xml?v=2017'>
   <meta name='theme-color' content='#ffffff'>
<!--End favicon-->

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idl_About_this_document.htm">
<LINK REL="previous" HREF="idl_write_fits_sb.htm">
<LINK REL="next" HREF="idl_About_this_document.htm">
</HEAD>

<body>

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="idl_write_fits_sb.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="idl_HEALPix_IDL_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="idl_About_this_document.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html462"
  HREF="idl_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<strong> Previous:</strong> <A
 HREF="idl_write_fits_sb.htm">write_fits_sb</A>

<strong>Up:</strong> <A
 HREF="idl_HEALPix_IDL_subroutines.htm">HEALPix/IDL subroutines</A>

<strong> Next:</strong> <A
 HREF="idl_About_this_document.htm">About this document ...</A>
<strong> Top:</strong> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION7900"></A>
<A ID="idl:write_tqu"></A>
<BR>
 
</H1>

<P>
<div class="facility"><SPAN CLASS="colordoc">write_tqu</SPAN></div><hr>
<H3>This IDL facility writes a temperature+polarization Healpix map (T,Q,U) into a
binary table FITS file, 
with optionally the error (dT,dQ,dU) and correlation (dQU, dTU, dTQ)
in separate extensions
</H3>
Location in HEALPix directory tree: <a href="https://healpix.sourceforge.io/src/3.80/src/idl/fits/write_tqu.pro"><strong>src/idl/fits/write_tqu.pro</strong></a>&nbsp;  

<P>
<hr><h2>FORMAT </h2><h3>IDL>
WRITE_TQU , <A HREF="#idl:write_tqu:File">File</A>, <A HREF="#idl:write_tqu:TQU">TQU</A>, [<A HREF="#idl:write_tqu:Coordsys">Coordsys=</A>, <A HREF="#idl:write_tqu:Nested">Nested=</A>, <A HREF="#idl:write_tqu:Ring">Ring=</A>, <A HREF="#idl:write_tqu:Ordering">Ordering=</A>, <A HREF="#idl:write_tqu:Error">Error=</A>, <A HREF="#idl:write_tqu:Extension">Extension=</A>, <A HREF="#idl:write_tqu:Help">Help=</A>, <A HREF="#idl:write_tqu:Hdr">Hdr=</A>, <A HREF="#idl:write_tqu:Xhdr">Xhdr=</A>, <A HREF="#idl:write_tqu:Units">Units=</A>, <A HREF="#idl:write_tqu:Help">Help=</A>]
</h3>

<P>
<hr>
<H2>QUALIFIERS</H2>
 
  <DL COMPACT><DT>
<B>File</B>
<DD><A ID="idl:write_tqu:File"></A>          name of a FITS file in which the maps are to be written

<P>
<DT>
<B>TQU</B>
<DD><A ID="idl:write_tqu:TQU"></A> array of Healpix maps of size (<!-- MATH
 $N_{\mathrm{pix}}$
 -->
<SPAN CLASS="MATH"><I>N</I><SUB>pix</SUB></SPAN>,3,<SPAN style="font-family:monospace">n_ext</SPAN>) where <!-- MATH
 $N_{\mathrm{pix}}$
 -->
<SPAN CLASS="MATH"><I>N</I><SUB>pix</SUB></SPAN> is the total
   number of Healpix pixels on the sky, and <SPAN style="font-family:monospace">n_ext</SPAN> <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.87ex; vertical-align: -0.41ex; " SRC="idl_img113.png"
 ALT="$\le$"></SPAN> 3.
<BR>
Three maps are written in each extension of the FITS file : 
<BR>      -the temperature+polarization Stokes parameters maps (T,Q,U) in
   extension 0 
<BR>      -the error maps (dT,dQ,dU) (if <SPAN style="font-family:monospace">n_ext</SPAN> <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.87ex; vertical-align: -0.41ex; " SRC="idl_img98.png"
 ALT="$\ge$"></SPAN> 2) in extension 1 
<BR>      -the correlation maps (dQU, dTU, dTQ) (if <SPAN style="font-family:monospace">n_ext</SPAN> = 3) in extension 2

<BR>
it is also possible to write 3 maps directly in a given
     extension (provided the preceding extension, if any, is already
     filled in)
     by setting <SPAN style="font-family:monospace">Extension</SPAN> to the extension number in which to write
     (0 based) and if <SPAN style="font-family:monospace">n_ext</SPAN> + <SPAN style="font-family:monospace">Extension</SPAN> <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.87ex; vertical-align: -0.41ex; " SRC="idl_img113.png"
 ALT="$\le$"></SPAN> 3

<P>
<DT>
<B>Coordsys=</B>
<DD><A ID="idl:write_tqu:Coordsys"></A>		  (optional), 
<BR>
if set to either 'C', 'E' or 'G',  specifies that the
		Healpix coordinate system is respectively Celestial=equatorial,
		  Ecliptic or Galactic.
		(The relevant keyword is then added/updated in the extension
		  header, but the map is NOT rotated)

<P>
<DT>
<B>Error=</B>
<DD><A ID="idl:write_tqu:Error"></A>		(optional output), 
<BR>
will take value 1 if file can not be written

<P>
<DT>
<B>Extension=</B>
<DD><A ID="idl:write_tqu:Extension"></A>		(optional), 
<BR>
extension unit a which to put the data (0 based). The physical
		interpretation of the maps is determined by the
		extension in which they are written
<BR>	<i>see also:</i>TQU

<P>
<DT>
<B>Hdr=</B>
<DD><A ID="idl:write_tqu:Hdr"></A>		  (optional), 
<BR>
string variable containing on input  the information to be added
		  to the primary header. (If already present, FITS reserved
		  keywords will be automatically updated).

<P>
<DT>
<B>Ordering=</B>
<DD><A ID="idl:write_tqu:Ordering"></A>		  (optional), 
<BR>
if set to either 'ring' or 'nested' (case un-sensitive),
		  specifies that the map is respectively in RING or NESTED
		  ordering scheme
<BR>		<i>see also:</i>Nested and Ring

<P>
<DT>
<B>Units=</B>
<DD><A ID="idl:write_tqu:Units"></A>		(optional), 
<BR>
string describing the physical units of the data set

<P>
<DT>
<B>Xhdr=</B>
<DD><A ID="idl:write_tqu:Xhdr"></A>		  (optional), 
<BR>
string variable containing on input  the information to be added
		  to the extension headerx. (If already present, FITS reserved
		  keywords will be automatically updated). It will be
		    repeated in each extension, except for TTYPE* and EXTNAME which
		    are generated by the routine and depend on the extension

<P>
</DL>

<P>
<hr><H2>KEYWORDS</H2>

  <DL COMPACT><DT>
<B>Help</B>
<DD><A ID="idl:write_tqu:Help"></A> if set, an extensive help is displayed and no
	file is written
	<DT>
<B>Nested</B>
<DD><A ID="idl:write_tqu:Nested"></A> if set, specifies that the map is in the NESTED ordering
	scheme
<BR>	<i>see also:</i>Ordering and Ring 
	<DT>
<B>Ring</B>
<DD><A ID="idl:write_tqu:Ring"></A> if set, specifies that the map is in the RING ordering
	scheme
<BR>	<i>see also:</i>Ordering and Nested
   </DL>

<P>
<hr> 
<H2>DESCRIPTION</H2> 
<blockquote>
<SPAN CLASS="colordoc">write_tqu</SPAN> writes out Stokes parameters (T,Q,U) maps for the whole
sky into a FITS file. It is also possible to write the error per pixel for each
map and the correlation between fields, as subsequent extensions of the same FITS
file (see qualifiers above). Therefore the file may have up to three extensions with three
maps in each. Extensions can be written together or one by one (in
their physical order) using the Extension option.
<BR>
For more information on the FITS file format supported in <strong>HEALPix</strong>, 
including the one implemented in write_tqu ,
see <kbd><A ID="tex2html98"
  HREF="https://healpix.sourceforge.io/data/examples/healpix_fits_specs.pdf">https://healpix.sourceforge.io/data/examples/healpix_fits_specs.pdf</A></kbd>.
</blockquote>

<P>
<hr><H2>RELATED ROUTINES</H2><h3>This section lists the routines related to <b><SPAN CLASS="colordoc">write_tqu</SPAN></b></h3>
 
  <DL COMPACT><DT>
<B>idl</B>
<DD>version 6.4 or more is necessary to run <SPAN CLASS="colordoc">write_tqu</SPAN>
  <DT>
<B><A HREF="idl_read_tqu.htm#idl:read_tqu">read_tqu</A></B>
<DD>This <strong>HEALPix</strong> IDL facility can be used to read in maps
  written by <SPAN CLASS="colordoc">write_tqu</SPAN>.
  <DT>
<B><A HREF="idl_read_fits_s.htm#idl:read_fits_s">read_fits_s</A></B>
<DD>This <strong>HEALPix</strong> IDL facility can be used to read
  into an IDL structure maps written by <SPAN CLASS="colordoc">write_tqu</SPAN>.
  <DT>
<B>sxaddpar</B>
<DD>This IDL routine (included in <strong>HEALPix</strong> package) can be used to update
  or add FITS keywords to the header(s) HDR or XHDR
<DT>
<B><A HREF="idl_write_fits_cut4.htm#idl:write_fits_cut4">write_fits_cut4</A>,
<A HREF="idl_write_fits_partial.htm#idl:write_fits_partial">write_fits_partial</A>,
<A HREF="idl_write_fits_map.htm#idl:write_fits_map">write_fits_map</A></B>
<DD><DT>
<B><A HREF="#idl:write_tqu">write_tqu</A>,
<A HREF="idl_write_fits_sb.htm#idl:write_fits_sb">write_fits_sb</A></B>
<DD><strong>HEALPix</strong> IDL routines to write cut-sky and partial maps, full-sky maps, polarized full-sky maps and
arbitrary data sets into FITS files
  </DL>

<P>
<HR><H2>EXAMPLE:</H2> 
<div class="texttt"><TABLE class="PAD " style="">
<TR><TD CLASS="LEFT">npix = <A HREF="idl_nside2npix.htm#idl:nside2npix">nside2npix</A>(64)</TD>
</TR>
<TR><TD CLASS="LEFT">TQU = randomn(seed,npix,3)</TD>
</TR>
<TR><TD CLASS="LEFT">write_tqu,  'map_polarization.fits', TQU, coord='G', /ring</TD>
</TR>
</TABLE></div>
<blockquote>
The array TQU is defined to contain a fictitious polarisation map, with
the 3 Stokes parameters T, Q and U. The map is assumed to be in
Galactic coordinates, with a RING ordering of the pixels and <!-- MATH
 $N_{\mathrm{side}}=64$
 -->
<SPAN CLASS="MATH"><I>N</I><SUB>side</SUB>=64</SPAN>.
<SPAN CLASS="colordoc">write_tqu</SPAN> writes out the contents of TQU into the extension 
of the FITS file 'map_polarization.fits'.
</blockquote>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="idl_write_fits_sb.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="idl_HEALPix_IDL_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="idl_About_this_document.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html462"
  HREF="idl_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<strong> Previous:</strong> <A
 HREF="idl_write_fits_sb.htm">write_fits_sb</A>

<strong>Up:</strong> <A
 HREF="idl_HEALPix_IDL_subroutines.htm">HEALPix/IDL subroutines</A>

<strong> Next:</strong> <A
 HREF="idl_About_this_document.htm">About this document ...</A>
<strong> Top:</strong> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.80, 2021-06-22
</ADDRESS>
</BODY>
</HTML>
