<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2020 (Released January 1, 2020) -->
<HTML lang="en">
<HEAD>
<TITLE>fits2cl</TITLE>
<META NAME="description" CONTENT="fits2cl">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2020">
<!--Begin favicon-->
   <link rel='apple-touch-icon' sizes='180x180' href='images/favicons/apple-touch-icon.png?v=2017'>
   <link rel='icon' type='image/png' sizes='32x32' href='images/favicons/favicon-32x32.png?v=2017'>
   <link rel='icon' type='image/png' sizes='16x16' href='images/favicons/favicon-16x16.png?v=2017'>
   <link rel='manifest' href='images/favicons/manifest.json?v=2017'>
   <link rel='mask-icon' href='images/favicons/safari-pinned-tab.svg?v=2017' color='#5bbad5'>
   <link rel='shortcut icon' href='images/favicons/favicon.ico?v=2017'>
   <meta name='apple-mobile-web-app-title' content='HEALPix'>
   <meta name='application-name' content='HEALPix'>
   <meta name='msapplication-config' content='images/favicons/browserconfig.xml?v=2017'>
   <meta name='theme-color' content='#ffffff'>
<!--End favicon-->

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idl_gaussbeam.htm">
<LINK REL="previous" HREF="idl_fits2alm.htm">
<LINK REL="next" HREF="idl_gaussbeam.htm">
</HEAD>

<body>

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="idl_fits2alm.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="idl_HEALPix_IDL_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="idl_gaussbeam.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html350"
  HREF="idl_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<strong> Previous:</strong> <A
 HREF="idl_fits2alm.htm">fits2alm</A>

<strong>Up:</strong> <A
 HREF="idl_HEALPix_IDL_subroutines.htm">HEALPix/IDL subroutines</A>

<strong> Next:</strong> <A
 HREF="idl_gaussbeam.htm">gaussbeam</A>
<strong> Top:</strong> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A ID="SECTION2300"></A>
<A ID="idl:fits2cl"></A>
<BR>
 
</H1>

<P>
<div class="facility"><SPAN CLASS="colordoc">fits2cl</SPAN></div><hr>
<H3>This IDL facility provides a means to
read from a FITS file an ascii or binary table extension containing power 
spectrum (<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN>) or spherical harmonics (<SPAN CLASS="MATH"><IMG
 STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="idl_img1.png"
 ALT="$a_{\ell m}$"></SPAN>) coefficients, and returns
the corresponding power spectrum (<!-- MATH
 $C(\ell) = \sum_m a_{\ell m}a^*_{\ell m} / (2\ell+1)$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.39ex; vertical-align: -0.68ex; " SRC="idl_img56.png"
 ALT="$C(\ell) = \sum_m a_{\ell m}a^*_{\ell m} / (2\ell+1)$"></SPAN>). Reads primary and extension headers if
required. The facility is intended to enable the user to read the
output from the <strong>HEALPix</strong> facility <SPAN  CLASS="textbf">anafast</SPAN>.
</H3>
Location in HEALPix directory tree: <a href="https://healpix.sourceforge.io/src/3.80/src/idl/fits/fits2cl.pro"><strong>src/idl/fits/fits2cl.pro</strong></a>&nbsp;  

<P>
<hr><h2>FORMAT </h2><h3>IDL>
<SPAN CLASS="colordoc">fits2cl</SPAN>, 
<A HREF="#idl:fits2cl:cl_array">cl_array</A>, 
[<A HREF="#idl:fits2cl:fitsfile">fitsfile</A>, <A HREF="#idl:fits2cl:extension">EXTENSION=</A> ,
<A HREF="#idl:fits2cl:hdr">HDR=</A> ,
<A HREF="#idl:fits2cl:help">/HELP</A>, 
<A HREF="#idl:fits2cl:interactive">/INTERACTIVE</A>, 
<A HREF="#idl:fits2cl:llfactor">LLFACTOR=</A>, 
<A HREF="#idl:fits2cl:multipoles">MULTIPOLES=</A>,  
<A HREF="#idl:fits2cl:planck1">/PLANCK1=</A>, 
<A HREF="#idl:fits2cl:planck2">/PLANCK2=</A>, 
<A HREF="#idl:fits2cl:planck3">/PLANCK3=</A>, 
<A HREF="#idl:fits2cl:rshow">/RSHOW</A>, 
<A HREF="#idl:fits2cl:show">/SHOW</A>, 
<A HREF="#idl:fits2cl:silent">/SILENT=</A>, 
<A HREF="#idl:fits2cl:wmap1">/WMAP1=</A>, 
<A HREF="#idl:fits2cl:wmap5">/WMAP5=</A>, 
<A HREF="#idl:fits2cl:wmap7">/WMAP7=</A>, 
<A HREF="#idl:fits2cl:xhdr">XHDR=</A>]
</h3>

<P>
<hr>
<H2>QUALIFIERS</H2>
 
  <DL COMPACT><DT>
<B>cl_array</B>
<DD><A ID="idl:fits2cl:cl_array"></A>real array of <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.04ex; vertical-align: -0.45ex; " SRC="idl_img57.png"
 ALT="$C_\ell$"></SPAN> coefficients read or computed from the
      file. The output dimension depends on the contents of the file. 
	This has dimension either (lmax+1,9) given in the sequence T E B
      TxE TxB ExB ExT BxT BxE <B>or</B>
       (lmax+1,6) given in the sequence T E B
      TxE TxB ExB <B>or</B> (lmax+1,4) for T E B TxE <B>or</B> (lmax+1) for T
    alone. 
<BR>
The convention for the power spectrum is that it is not
      normalised by the Harrison-Zeldovich (flat) spectrum.
<DT>
<B>fitsfile</B>
<DD><A ID="idl:fits2cl:fitsfile"></A>String containing the name of the FITS file to be read. The
    file contains either <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> power spectra or <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="idl_img1.png"
 ALT="$a_{\ell m}$"></SPAN> coefficients. In either
    cases, <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> is returned. If <SPAN style="font-family:monospace">fitsfile</SPAN> is not set, then
<A HREF="#idl:fits2cl:planck1"><SPAN style="font-family:monospace">/PLANCK1</SPAN></A>,
<A HREF="#idl:fits2cl:planck2"><SPAN style="font-family:monospace">/PLANCK2</SPAN></A>,
<A HREF="#idl:fits2cl:planck3"><SPAN style="font-family:monospace">/PLANCK3</SPAN></A>,
<A HREF="#idl:fits2cl:wmap1"><SPAN style="font-family:monospace">/WMAP1</SPAN></A>,
<A HREF="#idl:fits2cl:wmap5"><SPAN style="font-family:monospace">/WMAP5</SPAN></A> or
<A HREF="#idl:fits2cl:wmap7"><SPAN style="font-family:monospace">/WMAP7</SPAN></A> 
must be set.
  </DL>

<P>
<hr><H2>KEYWORDS</H2>

  <DL COMPACT><DT>
<B>EXTENSION=</B>
<DD><A ID="idl:fits2cl:extension"></A>extension unit to be read from FITS file: 
 either its 0-based ID number (ie, 0 for first extension <EM>after</EM> primary array) 
 or the case-insensitive value of its EXTNAME keyword.
    <DT>
<B>HDR =</B>
<DD><A ID="idl:fits2cl:hdr"></A>String array containing on output the primary header
      read from the FITS file. 
    <DT>
<B>/HELP</B>
<DD><A ID="idl:fits2cl:help"></A>If set, produces an extended help message (using the doc_library
    IDL command). 
    <DT>
<B>/INTERACTIVE</B>
<DD><A ID="idl:fits2cl:interactive"></A>If set, the plots generated by <A HREF="#idl:fits2cl:show"><SPAN style="font-family:monospace">/SHOW</SPAN></A> and <A HREF="#idl:fits2cl:rshow"><SPAN style="font-family:monospace">/RSHOW</SPAN></A> options are produced using iPlot routine, allowing 
           for interactive cropping, zooming and annotation of the plots. This
           requires IDL 6.4 or newer to work properly.
    <DT>
<B>LLFACTOR =</B>
<DD><A ID="idl:fits2cl:llfactor"></A>vector containing on output the factor <!-- MATH
 $\ell(\ell+1)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img58.png"
 ALT="$\ell(\ell+1)/2\pi$"></SPAN> which is often
          applied to <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> to flatten it for plotting purposes
    <DT>
<B>MULTIPOLES =</B>
<DD><A ID="idl:fits2cl:multipoles"></A>vector containing on output the multipoles
    <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="idl_img15.png"
 ALT="$\ell$"></SPAN> for which the power spectra are provided. They are either
<BR>           - read from the file (1st column in the Planck format),
<BR>          - or generated by the routine (assuming that all
               multipoles from 0 to lmax included are provided).
<DT>
<B>/PLANCK1</B>
<DD><A ID="idl:fits2cl:planck1"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><SPAN style="font-family:monospace">fitsfile</SPAN></A> 
           is not provided, then a Planck 2013+external data best fit
          model (<A HREF="idl_init_healpix_healpix_system.htm#idl:init_healpix">!healpix</A>.path.test+'planck2013ext_lcdm_cl_v1.fits'
which matches !healpix.path.test+'cl_planck1.fits') 
          defined up to lmax=4500, is read.
<BR>
See <A ID="tex2html36"
  HREF="https://healpix.sourceforge.io/src/3.80/test/README">!healpix.path.test+'README'</A>
for details
<DT>
<B>/PLANCK2</B>
<DD><A ID="idl:fits2cl:planck2"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><SPAN style="font-family:monospace">fitsfile</SPAN></A> 
           is not provided, then a Planck 2015 data best fit
          model (<A HREF="idl_init_healpix_healpix_system.htm#idl:init_healpix">!healpix</A>.path.test+'planck2015_lcdm_cl_v2.fits'
which matches !healpix.path.test+'cl_planck2.fits') 
          defined up to lmax=4900, is read.
<BR>
See <A ID="tex2html37"
  HREF="https://healpix.sourceforge.io/src/3.80/test/README">!healpix.path.test+'README'</A>
for details
<DT>
<B>/PLANCK3</B>
<DD><A ID="idl:fits2cl:planck3"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><SPAN style="font-family:monospace">fitsfile</SPAN></A> 
           is not provided, then a Planck 2018 data best fit
          model (<A ID="tex2html38"
  HREF="https://healpix.sourceforge.io/src/3.80/planck2018_lcdm_cl_v3.fits">!healpix.path.test+'planck2018_lcdm_cl_v3.fits'</A>
which matches <A HREF="idl_init_healpix_healpix_system.htm#idl:init_healpix">!healpix</A>.path.test+'cl_planck3.fits') 
          defined up to lmax=5000, is read.
<BR>
See <A ID="tex2html39"
  HREF="https://healpix.sourceforge.io/src/3.80/test/README">!healpix.path.test+'README'</A>
for details

<P>
<DT>
<B>/RSHOW</B>
<DD><A ID="idl:fits2cl:rshow"></A>If set, the raw power spectra <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> read from the file are plotted
    <DT>
<B>/SHOW</B>
<DD><A ID="idl:fits2cl:show"></A>If set, the rescaled power spectra <!-- MATH
 $\ell(\ell+1)C(\ell)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img59.png"
 ALT="$\ell(\ell+1)C(\ell)/2\pi$"></SPAN> are plotted
    <DT>
<B>/SILENT</B>
<DD><A ID="idl:fits2cl:silent"></A>If set, no message is issued during normal execution
<DT>
<B>/WMAP1</B>
<DD><A ID="idl:fits2cl:wmap1"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><SPAN style="font-family:monospace">fitsfile</SPAN></A> 
           is not provided, then one WMAP-1yr best fit
          model
(<A HREF="idl_init_healpix_healpix_system.htm#idl:init_healpix">!healpix</A>.path.test+'wmap_lcdm_pl_model_yr1_v1.fits'
which currently matches !healpix.path.test+'cl.fits') 
          defined up to lmax=3000, is read.
<BR>
See <A ID="tex2html40"
  HREF="https://healpix.sourceforge.io/src/3.80/test/README">!healpix.path.test+'README'</A>
for details
<DT>
<B>/WMAP5</B>
<DD><A ID="idl:fits2cl:wmap5"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><SPAN style="font-family:monospace">fitsfile</SPAN></A>
           is not provided, then one WMAP-5yr best fit
          model (<A HREF="idl_init_healpix_healpix_system.htm#idl:init_healpix">!healpix</A>.path.test+'wmap_lcdm_sz_lens_wmap5_cl_v3.fits'
which matches !healpix.path.test+'cl_wmap5.fits') 
          defined up to lmax=2000, is read.
<BR>
See <A ID="tex2html41"
  HREF="https://healpix.sourceforge.io/src/3.80/test/README">!healpix.path.test+'README'</A>
for details
<DT>
<B>/WMAP7</B>
<DD><A ID="idl:fits2cl:wmap7"></A>If set, and <A HREF="#idl:fits2cl:fitsfile"><SPAN style="font-family:monospace">fitsfile</SPAN></A>
           is not provided, then one WMAP-7yr best fit
          model (<A HREF="idl_init_healpix_healpix_system.htm#idl:init_healpix">!healpix</A>.path.test+'wmap_lcdm_sz_lens_wmap7_cl_v4.fits'
which matches !healpix.path.test+'cl_wmap7.fits') 
          defined up to lmax=3726, is read.
<BR>          <B>Note:</B> As opposed to the other WMAP spectra mentionned above, it includes
             a non-vanishing B (or CURL) power spectrum 
             induced by lensing of E (or GRAD) polarization.
<BR>
See <A ID="tex2html42"
  HREF="https://healpix.sourceforge.io/src/3.80/test/README">!healpix.path.test+'README'</A>
for details
<DT>
<B>XHDR =</B>
<DD><A ID="idl:fits2cl:xhdr"></A>String array containing on output the extension header
      read from the FITS file. 
  </DL>

<P>
<hr> 
<H2>DESCRIPTION</H2> 
<blockquote>
<SPAN CLASS="colordoc">fits2cl</SPAN> reads the power spectrum coefficients from a FITS
file containing an ascii table extension. Descriptive headers conforming
to the FITS convention can also be read from the input file.

</blockquote>

<P>
<hr><H2>RELATED ROUTINES</H2><h3>This section lists the routines related to <b><SPAN CLASS="colordoc">fits2cl</SPAN></b></h3>
 
  <DL COMPACT><DT>
<B>idl</B>
<DD>version 6.4 or more is necessary to run <SPAN CLASS="colordoc">fits2cl</SPAN>.
    <DT>
<B><A HREF="idl_bin_llcl.htm#idl:bin_llcl">bin_llcl</A></B>
<DD>facility to bin a spectrum read
with <SPAN CLASS="colordoc">fits2cl</SPAN>.
    <DT>
<B><A HREF="idl_bl2fits.htm#idl:bl2fits">bl2fits</A></B>
<DD>facility to write a window function into a FITS file.
    <DT>
<B><A HREF="idl_cl2fits.htm#idl:cl2fits">cl2fits</A></B>
<DD>provides the complimentary routine to write a
      power spectrum to a FITS file.
    <DT>
<B><A HREF="idl_fits2alm.htm#idl:fits2alm">fits2alm</A>, <A HREF="idl_alm2fits.htm#idl:alm2fits">alm2fits</A></B>
<DD>routines to read and write <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.46ex; vertical-align: -0.45ex; " SRC="idl_img1.png"
 ALT="$a_{\ell m}$"></SPAN> coefficients
    <DT>
<B><A HREF="idl_ianafast.htm#idl:ianafast">ianafast</A></B>
<DD>IDL routine computing <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> files
that can be read by <SPAN CLASS="colordoc">fits2cl</SPAN>.
    <DT>
<B>anafast</B>
<DD>F90 facility computing <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> files that can be read by <SPAN CLASS="colordoc">fits2cl</SPAN>.
  </DL>

<P>
<HR><H2>EXAMPLE:</H2> 
<div class="texttt"><TABLE class="PAD " style="">
<TR><TD CLASS="LEFT"><SPAN CLASS="colordoc">fits2cl</SPAN>, pwrsp, '$HEALPIX/test/cl.fits', $</TD>
</TR>
<TR><TD CLASS="LEFT">HDR=hdr, XHDR=xhdr, MULTI=l, LLFACT=fll</TD>
</TR>
<TR><TD CLASS="LEFT">plot, l, powrsp[*,0]*fll</TD>
</TR>
</TABLE></div>
<blockquote>
<SPAN CLASS="colordoc">fits2cl</SPAN> reads a power spectrum <SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img4.png"
 ALT="$C(\ell)$"></SPAN> from the input FITS file 
<SPAN style="font-family:monospace">$HEALPIX/test/cl.fits</SPAN>
into the variable <SPAN style="font-family:monospace">pwrsp</SPAN>,  with optional headers
passed by the string variables <SPAN style="font-family:monospace">hdr</SPAN> and <SPAN style="font-family:monospace">xhdr</SPAN>. The multipoles <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="idl_img15.png"
 ALT="$\ell$"></SPAN> and
factors <!-- MATH
 $\ell(\ell+1)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img58.png"
 ALT="$\ell(\ell+1)/2\pi$"></SPAN> are read into <SPAN style="font-family:monospace">l</SPAN> and <SPAN style="font-family:monospace">fll</SPAN> respectively.
<!-- MATH
 $\ell(\ell+1) C(\ell)/2\pi$
 -->
<SPAN CLASS="MATH"><IMG
 STYLE="height: 2.33ex; vertical-align: -0.68ex; " SRC="idl_img59.png"
 ALT="$\ell(\ell+1)C(\ell)/2\pi$"></SPAN> vs <SPAN CLASS="MATH"><IMG
 STYLE="height: 1.69ex; vertical-align: -0.10ex; " SRC="idl_img15.png"
 ALT="$\ell$"></SPAN> is then plotted.
</blockquote>

<P>

<P>

<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="idl_fits2alm.htm">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A
 HREF="idl_HEALPix_IDL_subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="idl_gaussbeam.htm">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A ID="tex2html350"
  HREF="idl_TABLE_CONTENTS.htm">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A>  
<BR>
<strong> Previous:</strong> <A
 HREF="idl_fits2alm.htm">fits2alm</A>

<strong>Up:</strong> <A
 HREF="idl_HEALPix_IDL_subroutines.htm">HEALPix/IDL subroutines</A>

<strong> Next:</strong> <A
 HREF="idl_gaussbeam.htm">gaussbeam</A>
<strong> Top:</strong> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.80, 2021-06-22
</ADDRESS>
</BODY>
</HTML>
