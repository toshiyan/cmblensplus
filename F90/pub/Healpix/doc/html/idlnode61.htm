<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>read_tqu</TITLE>
<META NAME="description" CONTENT="read_tqu">
<META NAME="keywords" CONTENT="idl">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="idl.css">

<LINK REL="next" HREF="idlnode62.htm">
<LINK REL="previous" HREF="idlnode60.htm">
<LINK REL="up" HREF="idl.htm">
<LINK REL="next" HREF="idlnode62.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html963"
  HREF="idlnode60.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html969"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html973"
  HREF="idlnode62.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html971"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html964"
  HREF="idlnode60.htm">read_fits_s</A>

<B>Up:</B> <A NAME="tex2html970"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html974"
  HREF="idlnode62.htm">remove_dipole</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION000610000000000000000"></A>
<A NAME="idl:read_tqu"></A>
<BR>
 
</H1>
<P>
<b><font size=+6><FONT COLOR="#CC0000">read_tqu</FONT></font></b><hr>
<H3>This IDL facility reads a temperature+polarization Healpix map
(T,Q,U) from a binary table FITS file, 
with optionally the error (dT,dQ,dU) and correlation (dQU, dTU, dTQ)
from separate extensions
</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/845/tree/trunk/src/idl/fits/read_tqu.pro"><b>src/idl/fits/read_tqu.pro</b></a>&nbsp;  
<P>
<hr><h1>FORMAT </h1><h3>IDL>
READ_TQU , <A HREF="#idl:read_tqu:File">File</A>, <A HREF="#idl:read_tqu:TQU">TQU</A>, [<A HREF="#idl:read_tqu:Extension">Extension=</A>, <A HREF="#idl:read_tqu:Hdr">Hdr=</A>, <A HREF="#idl:read_tqu:Xhdr">Xhdr=</A>, <A HREF="#idl:read_tqu:HELP">/HELP</A>, <A HREF="#idl:read_tqu:Nside">Nside=</A>, <A HREF="#idl:read_tqu:Ordering">Ordering=</A>, <A HREF="#idl:read_tqu:Coordsys">Coordsys=</A>]
</h3>
<P>
<hr>
<H1>QUALIFIERS</H1>
 
  </SMALL><DL COMPACT><DT>
<B>File</B>
<DD><A NAME="idl:read_tqu:File"></A>          name of a FITS file from which the maps are to be read

<P>
<DT>
<B>TQU</B>
<DD><A NAME="idl:read_tqu:TQU"></A> : 
array of Healpix maps of size (<SPAN CLASS="MATH"><IMG
 WIDTH="39" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg88.png"
 ALT="$N_{\rm pix}$"></SPAN>,3,<TT>n_ext</TT>) where <SPAN CLASS="MATH"><IMG
 WIDTH="39" HEIGHT="35" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg88.png"
 ALT="$N_{\rm pix}$"></SPAN> is the total
   number of Healpix pixels on the sky, and <TT>n_ext</TT> <SPAN CLASS="MATH"><IMG
 WIDTH="19" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="idlimg93.png"
 ALT="$\le$"></SPAN> 3 is
   the number of extensions read
<BR>
Three maps are available in each extension of the FITS file : 
<BR>      -the temperature+polarization Stokes parameters maps (T,Q,U) in
   extension 0 
<BR>      -the error maps (dT,dQ,dU) in extension 1 (if applicable)
<BR>      -the correlation maps (dQU, dTU, dTQ) in extension 2 (if applicable)

<P>
<DT>
<B>Extension=</B>
<DD><A NAME="idl:read_tqu:Extension"></A>		(optional), 
<BR>
extension unit to be read from FITS file: 
 either its 0-based ID number (ie, 0 for first extension <EM>after</EM> primary array) 
 or the case-insensitive value of its EXTNAME keyword.
	If absent, all available extensions are read.

<P>
<DT>
<B>Hdr=</B>
<DD><A NAME="idl:read_tqu:Hdr"></A>		  (optional), 
<BR>
string variable containing on output  the contents of the primary header. (If already present, FITS reserved
		  keywords will be automatically updated).

<P>
<DT>
<B>Xhdr=</B>
<DD><A NAME="idl:read_tqu:Xhdr"></A>		  (optional), 
<BR>
string variable containing on output the contents of the
		  extension header. If 
                  several extensions are read, then the extension 
                  headers are returned appended into one string array.

<P>
<DT>
<B>Nside=</B>
<DD><A NAME="idl:read_tqu:Nside"></A>		(optional), 
<BR>
returns on output the <b>HEALPix</b> resolution parameter, as read
		from the FITS header. Set to -1 if not found

<P>
<DT>
<B>Ordering=</B>
<DD><A NAME="idl:read_tqu:Ordering"></A>	        (optional), 
<BR>
returns on output the pixel ordering, as read from the FITS
	        header. Either 'RING' or 'NESTED' or ' ' (if not found).

<P>
<DT>
<B>Coordsys=</B>
<DD><A NAME="idl:read_tqu:Coordsys"></A>	        (optional), 
<BR>
returns on output the astrophysical coordinate system used, 
		as read from FITS header (value of keywords COORDSYS or SKYCOORD)

<P>
</DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr><H1>KEYWORDS</H1>

  </SMALL><DL COMPACT><DT>
<B>/HELP</B>
<DD><A NAME="idl:read_tqu:HELP"></A> if set, an extensive help is displayed and no
	file is read
   </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<hr> 
<H1>DESCRIPTION</H1> 
<blockquote>
<FONT COLOR="#CC0000">read_tqu</FONT> reads out Stokes parameters (T,Q,U) maps for the whole
sky into a FITS file. It is also possible to read the error per pixel for each
map and the correlation between fields, as subsequent extensions of the same FITS
file (see qualifiers above). Therefore the file may have up to three extensions with three
maps in each. Extensions can be written together or one by one (in
their physical order) using the Extension option
</blockquote>
<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">read_tqu</FONT></b></h3>
 
  </SMALL><DL COMPACT><DT>
<B>idl</B>
<DD>version 6.4 or more is necessary to run <FONT COLOR="#CC0000">read_tqu</FONT>
  <DT>
<B>synfast</B>
<DD>This <b>HEALPix</b> f90 facility can be used to generate
  temperature+polarization maps that can be read with <FONT COLOR="#CC0000">read_tqu</FONT>
  <DT>
<B><A HREF="idlnode73.htm#idl:write_tqu">write_tqu</A></B>
<DD>This <b>HEALPix</b> IDL facility can be used to write
  out temperature+polarization that can be read by <FONT COLOR="#CC0000">read_tqu</FONT>.
  <DT>
<B><A HREF="idlnode58.htm#idl:read_fits_cut4">read_fits_cut4</A>,
<A HREF="idlnode59.htm#idl:read_fits_map">read_fits_map</A></B>
<DD><DT>
<B><A HREF="#idl:read_tqu">read_tqu</A>,
<A HREF="idlnode60.htm#idl:read_fits_s">read_fits_s</A></B>
<DD><b>HEALPix</b> IDL routines to read cut-sky maps, full-sky maps, polarized full-sky maps and
arbitrary data sets from FITS files
  <DT>
<B><A HREF="idlnode60.htm#idl:read_fits_s">read_fits_s</A></B>
<DD>This general purpose <b>HEALPix</b> IDL facility can be used to read
  into an IDL structure maps contained in binary table FITS files.
  <DT>
<B>sxpar</B>
<DD>This IDL routine (included in <b>HEALPix</b> package) can be
  used to extract FITS keywords from the header(s) HDR or XHDR read with <FONT COLOR="#CC0000">read_tqu</FONT>.
  </DL><SMALL CLASS="FOOTNOTESIZE">

<P>
<HR><H1>EXAMPLE:</H1> 
<tt></SMALL><TABLE CELLPADDING=3>
<TR><TD ALIGN="LEFT"><SMALL CLASS="FOOTNOTESIZE"> read_tqu, 'map_polarization.fits', TQU, xhdr=xhdr</SMALL></TD>
</TR>
</TABLE><SMALL CLASS="FOOTNOTESIZE"></tt>
<blockquote>
Reads into <TT>TQU</TT> the polarization maps contained in the FITS file
'map_polarization.fits'.
The variable <TT>xhdr</TT> will contain the extension(s) header.
</blockquote>
<P>
<SMALL CLASS="FOOTNOTESIZE"></SMALL>
<P>

<P>

<P>
<SMALL CLASS="FOOTNOTESIZE">
 </SMALL>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html963"
  HREF="idlnode60.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html969"
  HREF="idl.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html973"
  HREF="idlnode62.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html971"
  HREF="idlnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html964"
  HREF="idlnode60.htm">read_fits_s</A>

<B>Up:</B> <A NAME="tex2html970"
  HREF="idl.htm">HEALPix/IDL subroutines</A>

<B> Next:</B> <A NAME="tex2html974"
  HREF="idlnode62.htm">remove_dipole</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.31, 2016-08-26
</ADDRESS>
</BODY>
</HTML>
